(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    186069,       4646]
NotebookOptionsPosition[    171630,       4178]
NotebookOutlinePosition[    172777,       4211]
CellTagsIndexPosition[    172734,       4208]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["EIT with hyperfine states (single atom)", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.523334737109375*^9, 3.52333474878125*^9}, {
  3.58833192947324*^9, 3.588331943301461*^9}}],

Cell["N.B. has not been extensively tested yet (27 Sep. 2013)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.523333607859375*^9, 3.523333621328125*^9}, {
  3.523333687546875*^9, 3.523333691640625*^9}, {3.52333422484375*^9, 
  3.523334256875*^9}, {3.523334700296875*^9, 3.52333472521875*^9}, {
  3.523334763796875*^9, 3.52333476815625*^9}, {3.588407137921617*^9, 
  3.5884071441290827`*^9}, {3.5892229255969667`*^9, 3.589222925648719*^9}},
 FontFamily->"Verdana",
 FontSize->14],

Cell[CellGroupData[{

Cell["", "Subsubtitle",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"nEval", "=", "19"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59819527839058*^9, 3.5981952885416965`*^9}, {
  3.6110299540898857`*^9, 3.6110299998384113`*^9}, {3.611044200492872*^9, 
  3.611044235674528*^9}, {3.6110442696359367`*^9, 3.611044336408799*^9}, {
  3.611044596970673*^9, 3.611044679855487*^9}, {3.611044721121435*^9, 
  3.611044757126872*^9}, {3.611045104064245*^9, 3.6110451632981052`*^9}, {
  3.61104523131808*^9, 3.611045297801537*^9}, {3.611045604532776*^9, 
  3.611045605562801*^9}}],

Cell[CellGroupData[{

Cell["Prepare equations", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.589304841683259*^9, 3.589304844698259*^9}}],

Cell[CellGroupData[{

Cell["Some handy definitions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.588334346292163*^9, 3.588334362485635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nstates", "=", "18"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"commutator", "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"m", ".", "n"}], "-", 
   RowBox[{"n", ".", "m"}]}]}], "\n", 
 RowBox[{
  RowBox[{"d\[Rho]Lindblad", "[", 
   RowBox[{"\[Rho]_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"c", ".", "\[Rho]", ".", 
    RowBox[{"c", "\[ConjugateTranspose]"}]}], "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "\[ConjugateTranspose]"}], ".", "c", ".", "\[Rho]"}], "+", 
      RowBox[{"\[Rho]", ".", 
       RowBox[{"c", "\[ConjugateTranspose]"}], ".", "c"}]}], 
     ")"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.523290809921875*^9, 3.5232908339375*^9}, {
   3.52333332665625*^9, 3.5233333449375*^9}, {3.523334784828125*^9, 
   3.523334814*^9}, {3.5883319629343843`*^9, 3.588331962989912*^9}, 
   3.58833434351822*^9, {3.5883343789883003`*^9, 3.588334383557064*^9}, 
   3.588402310040719*^9, {3.589224854831468*^9, 3.589224885111854*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]Mat2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nstates"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "\[Rho]Mat2", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883518694634867`*^9, 3.588351895221107*^9}, 
   3.589222941390679*^9, {3.5892996264814425`*^9, 3.5892996378794427`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]Mat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nstates"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "\[Rho]Mat", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5889131383848867`*^9, 3.588913149137961*^9}, 
   3.5892229452936*^9, {3.5892996439604425`*^9, 3.589299647383443*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]19", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "19"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5893023951772585`*^9, 3.589302396265259*^9}}],

Cell["Table of Clebsch - Gordan coefficients", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.58891295552684*^9, 3.588912966135888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cgtq", "[", 
   RowBox[{"Fg_", ",", "Fe_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"cgtq", "[", 
    RowBox[{"Fg", ",", "Fe", ",", "q"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"me", "-", "mg"}], "==", "q"}], ",", 
       RowBox[{"ClebschGordan", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Fg", ",", "mg"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Fe", ",", "me"}], "}"}]}], "]"}], ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"me", ",", 
       RowBox[{"-", "Fe"}], ",", "Fe"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mg", ",", 
       RowBox[{"-", "Fg"}], ",", "Fg"}], "}"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883360258615303`*^9, 3.5883360294227743`*^9}, 
   3.588336059756607*^9, {3.588336100160242*^9, 3.5883361095001802`*^9}}],

Cell[TextData[{
 "Insert a submatrix into a bigger matrix; ",
 StyleBox["insert", "Input"],
 " replaces the existing values, ",
 StyleBox["insertAdd", "Input"],
 " adds the submatrix to the existing matrix ."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.588912971623488*^9, 3.588913080260014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"insert", "[", 
   RowBox[{"mat_", ",", "submat_", ",", "ri_", ",", "ci_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tmp", "=", "mat"}], ",", 
      RowBox[{"rows", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "submat", "]"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"cols", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "submat", "]"}], "\[LeftDoubleBracket]", 
        "2", "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"ri", ";;", 
         RowBox[{"ri", "+", "rows", "-", "1"}]}], ",", 
        RowBox[{"ci", ";;", 
         RowBox[{"ci", "+", "cols", "-", "1"}]}]}], "\[RightDoubleBracket]"}],
       "=", "submat"}], ";", "tmp"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"insertAdd", "[", 
   RowBox[{"mat_", ",", "submat_", ",", "ri_", ",", "ci_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tmp", "=", "mat"}], ",", 
      RowBox[{"rows", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "submat", "]"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"cols", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "submat", "]"}], "\[LeftDoubleBracket]", 
        "2", "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"ri", ";;", 
         RowBox[{"ri", "+", "rows", "-", "1"}]}], ",", 
        RowBox[{"ci", ";;", 
         RowBox[{"ci", "+", "cols", "-", "1"}]}]}], "\[RightDoubleBracket]"}],
       "+=", "submat"}], ";", "tmp"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588347667615562*^9, 3.5883476678540897`*^9}, {
  3.5883477071876373`*^9, 3.588347723356827*^9}, {3.58834781270547*^9, 
  3.588347816568542*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lowering", "[", 
   RowBox[{"i_", ",", "f_"}], "]"}], ":=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "i"}], "}"}], "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "lowering", " ", "operator", " ", "from", " ", "state", " ", "i", " ", 
    "to", " ", "state", " ", "f"}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.5884023281086903`*^9}],

Cell["\<\
Reduced dipole matrix elements; notation as in Cornelussen thesis, Eq. (2.43)\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5889994751333838`*^9, 3.588999480097286*^9}, 
   3.588999572465588*^9, {3.589190915675674*^9, 3.589190927234044*^9}, {
   3.589191094786574*^9, 3.589191104525887*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dff", "[", 
   RowBox[{"i_", ",", "jg_", ",", "je_", ",", "fg_", ",", "fe_"}], "]"}], "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"i", "+", "je", "+", "fg", "+", "1"}]], 
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "fg"}], "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "je"}], "+", "1"}], ")"}]}]], 
   RowBox[{"SixJSymbol", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fg", ",", "fe", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"je", ",", "jg", ",", "i"}], "}"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5889994869763193`*^9, 3.588999512493586*^9}, {
   3.588999586917159*^9, 3.588999614440557*^9}, 3.589000240267062*^9, {
   3.589191115107211*^9, 3.589191148130124*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"1", "+", "fg", "+", "i", "+", "je"}]], " ", 
  SqrtBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "fg"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "je"}]}], ")"}]}]], " ", 
  RowBox[{"SixJSymbol", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fg", ",", "fe", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"je", ",", "jg", ",", "i"}], "}"}]}], "]"}]}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589000240803494*^9, 3.589041301761807*^9, 
  3.589188616692676*^9, 3.589191149835753*^9, 3.5892176694458714`*^9, 
  3.589223190334988*^9, 3.589225347581973*^9, 3.589225614671239*^9, 
  3.589299187390443*^9, 3.589301959507259*^9, 3.589304816666259*^9, 
  3.589304848164259*^9, 3.5893053689062586`*^9, 3.589307301071322*^9, 
  3.5893484668674693`*^9, 3.5893840377710323`*^9, 3.589396849526091*^9, 
  3.5894670910750437`*^9, 3.5894822012243185`*^9, 3.589482277707966*^9, 
  3.589513799731417*^9, 3.589515126472417*^9, 3.589528040755069*^9, 
  3.589528736*^9, 3.589788454112111*^9, 3.589788561970111*^9, 
  3.589792296501793*^9, 3.5898685267819557`*^9, 3.596441265055106*^9, 
  3.5964825683229246`*^9, 3.5980654548938475`*^9, 3.5980980009891295`*^9, 
  3.598196071326687*^9, 3.5981969146959662`*^9, 3.611028636940681*^9, 
  3.611029905197146*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"djj", "[", 
   RowBox[{"s_", ",", "lg_", ",", "le_", ",", "jg_", ",", "je_"}], "]"}], "=", 
  RowBox[{"dff", "[", 
   RowBox[{"s", ",", "lg", ",", "le", ",", "jg", ",", "je"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5889996168300056`*^9, 3.588999619383018*^9}, {
   3.588999693036628*^9, 3.5889997525405416`*^9}, 3.5890002310151987`*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"1", "+", "jg", "+", "le", "+", "s"}]], " ", 
  SqrtBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "jg"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "le"}]}], ")"}]}]], " ", 
  RowBox[{"SixJSymbol", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"jg", ",", "je", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"le", ",", "lg", ",", "s"}], "}"}]}], "]"}]}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.589000232932849*^9, 3.5890002479386787`*^9}, 
   3.5890206772791843`*^9, 3.58918861674994*^9, 3.5891911781630917`*^9, 
   3.589217669494405*^9, 3.589223190400692*^9, 3.589225347616006*^9, 
   3.589225614706543*^9, 3.589299187422443*^9, 3.589301959539259*^9, 
   3.589304816699259*^9, 3.5893048481962585`*^9, 3.589305368943259*^9, 
   3.5893073011343284`*^9, 3.5893484668974657`*^9, 3.589384037801032*^9, 
   3.5893968495560904`*^9, 3.5894670911218433`*^9, 3.589482201268323*^9, 
   3.589482277734969*^9, 3.589513799771417*^9, 3.589515126500417*^9, 
   3.5895280407720704`*^9, 3.589528736046875*^9, 3.589788454137111*^9, 
   3.589788561992111*^9, 3.5897922965367966`*^9, 3.589868526848963*^9, 
   3.5964412650751047`*^9, 3.5964825683579245`*^9, 3.598065454916847*^9, 
   3.59809800101213*^9, 3.5981960713466873`*^9, 3.598196914715967*^9, 
   3.611028636983088*^9, 3.611029905231982*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Branching ratios for the D1 line", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.589223019175046*^9, 3.5892230285985937`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "0", ",", "1", ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["1", "2"]}], "]"}], 
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["1", "2"], ",", "fg", ",", "1"}], "]"}]}], ")"}], "2"], 
   ",", 
   RowBox[{"{", 
    RowBox[{"fg", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "0", ",", "1", ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["1", "2"]}], "]"}], 
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["1", "2"], ",", "fg", ",", "2"}], "]"}]}], ")"}], "2"], 
   ",", 
   RowBox[{"{", 
    RowBox[{"fg", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589191817277687*^9, 3.589191818686133*^9}, {
  3.5891919807774878`*^9, 3.5891920378711977`*^9}, {3.589192079430893*^9, 
  3.5891921028595057`*^9}, {3.58919221599127*^9, 3.589192251212592*^9}, {
  3.589217705138279*^9, 3.5892177736456947`*^9}, {3.589217834124752*^9, 
  3.5892178730264683`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "6"], ",", 
   FractionBox["5", "6"]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.589192038639028*^9, 3.589192103515917*^9, {3.5892176610382223`*^9, 
   3.5892176696688347`*^9}, {3.589217746034012*^9, 3.589217774806299*^9}, {
   3.5892178508386583`*^9, 3.5892178740056057`*^9}, 3.589223190439932*^9, 
   3.589225347664258*^9, 3.589225614739819*^9, 3.5892991874794426`*^9, 
   3.589301959573259*^9, 3.589304816738259*^9, 3.5893048482292585`*^9, 
   3.589305368985259*^9, 3.589307301184333*^9, 3.589348466927462*^9, 
   3.5893840378410325`*^9, 3.5893968495960884`*^9, 3.589467091168644*^9, 
   3.589482201301326*^9, 3.589482277759971*^9, 3.589513799805417*^9, 
   3.589515126534417*^9, 3.5895280408630795`*^9, 3.58952873609375*^9, 
   3.589788454166111*^9, 3.589788562022111*^9, 3.589792296580801*^9, 
   3.5898685268869667`*^9, 3.5964412651251*^9, 3.5964825684169245`*^9, 
   3.598065454943847*^9, 3.59809800104313*^9, 3.598196071376688*^9, 
   3.598196914745968*^9, 3.611028637019422*^9, 3.61102990526366*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.589192038639028*^9, 3.589192103515917*^9, {3.5892176610382223`*^9, 
   3.5892176696688347`*^9}, {3.589217746034012*^9, 3.589217774806299*^9}, {
   3.5892178508386583`*^9, 3.5892178740056057`*^9}, 3.589223190439932*^9, 
   3.589225347664258*^9, 3.589225614739819*^9, 3.5892991874794426`*^9, 
   3.589301959573259*^9, 3.589304816738259*^9, 3.5893048482292585`*^9, 
   3.589305368985259*^9, 3.589307301184333*^9, 3.589348466927462*^9, 
   3.5893840378410325`*^9, 3.5893968495960884`*^9, 3.589467091168644*^9, 
   3.589482201301326*^9, 3.589482277759971*^9, 3.589513799805417*^9, 
   3.589515126534417*^9, 3.5895280408630795`*^9, 3.58952873609375*^9, 
   3.589788454166111*^9, 3.589788562022111*^9, 3.589792296580801*^9, 
   3.5898685268869667`*^9, 3.5964412651251*^9, 3.5964825684169245`*^9, 
   3.598065454943847*^9, 3.59809800104313*^9, 3.598196071376688*^9, 
   3.598196914745968*^9, 3.611028637019422*^9, 3.611029905265175*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Branching ratios for the D2 line", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5892230363949223`*^9, 3.589223046292169*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "0", ",", "1", ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"]}], "]"}], 
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"], ",", "fg", ",", "0"}], "]"}]}], ")"}], "2"], 
   ",", 
   RowBox[{"{", 
    RowBox[{"fg", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "0", ",", "1", ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"]}], "]"}], 
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"], ",", "fg", ",", "1"}], "]"}]}], ")"}], "2"], 
   ",", 
   RowBox[{"{", 
    RowBox[{"fg", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "0", ",", "1", ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"]}], "]"}], 
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"], ",", "fg", ",", "2"}], "]"}]}], ")"}], "2"], 
   ",", 
   RowBox[{"{", 
    RowBox[{"fg", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "0", ",", "1", ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"]}], "]"}], 
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["3", "2"], ",", "fg", ",", "3"}], "]"}]}], ")"}], "2"], 
   ",", 
   RowBox[{"{", 
    RowBox[{"fg", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589191817277687*^9, 3.589191818686133*^9}, {
  3.5891919807774878`*^9, 3.5891920378711977`*^9}, {3.589192079430893*^9, 
  3.5891921028595057`*^9}, {3.58919221599127*^9, 3.589192251212592*^9}, {
  3.589217705138279*^9, 3.5892177736456947`*^9}, {3.589217834124752*^9, 
  3.5892178730264683`*^9}, {3.589217909653352*^9, 3.58921791812521*^9}, {
  3.589217954678692*^9, 3.5892179842684937`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SixJSymbol", "::", "tri"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(SixJSymbol[\\(\\(\\(\\({2, 0, 1}\\)\\), \
\\(\\({3\\/2, 1\\/2, 3\\/2}\\)\\)\\)\\)]\\)\[NoBreak] is not triangular. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/SixJSymbol\\\", ButtonNote -> \
\\\"SixJSymbol::tri\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{3.5892179859185247`*^9, 3.589223190558688*^9, 
  3.589225348242075*^9, 3.589225614772914*^9, 3.5892991875834427`*^9, 
  3.589301959620259*^9, 3.589304816879259*^9, 3.5893048482812586`*^9, 
  3.5893053691512585`*^9, 3.5893073014773626`*^9, 3.5893484671674333`*^9, 
  3.5893840379910326`*^9, 3.589396849766082*^9, 3.5894670913714437`*^9, 
  3.589482201467343*^9, 3.5894822777929745`*^9, 3.589513799870417*^9, 
  3.5895151265854173`*^9, 3.5895280411111045`*^9, 3.589528736390625*^9, 
  3.5897884543321114`*^9, 3.5897885621481113`*^9, 3.589792296776821*^9, 
  3.589868526959974*^9, 3.596441265435072*^9, 3.596482568731925*^9, 
  3.598065455114847*^9, 3.5980980012181296`*^9, 3.5981960715166903`*^9, 
  3.5981969149059744`*^9, 3.611028637260767*^9, 3.61102990533642*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589217941009054*^9, 3.589217985921117*^9, 
  3.5892231905613623`*^9, 3.5892253482585297`*^9, 3.589225614773982*^9, 
  3.589299187586443*^9, 3.589301959624259*^9, 3.589304816881259*^9, 
  3.589304848283259*^9, 3.589305369152259*^9, 3.5893073014813633`*^9, 
  3.5893484671674333`*^9, 3.5893840380010324`*^9, 3.589396849766082*^9, 
  3.5894670913714437`*^9, 3.5894822014693427`*^9, 3.589482277793975*^9, 
  3.589513799873417*^9, 3.589515126587417*^9, 3.589528041113105*^9, 
  3.589528736390625*^9, 3.589788454334111*^9, 3.5897885621491113`*^9, 
  3.589792296778821*^9, 3.5898685269719753`*^9, 3.596441265445071*^9, 
  3.596482568733925*^9, 3.598065455118847*^9, 3.5980980012191296`*^9, 
  3.5981960715166903`*^9, 3.5981969149059744`*^9, 3.6110286372620173`*^9, 
  3.611029905337722*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["5", "6"], ",", 
   FractionBox["1", "6"]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589217941009054*^9, 3.589217985921117*^9, 
  3.5892231905613623`*^9, 3.5892253482585297`*^9, 3.589225614773982*^9, 
  3.589299187586443*^9, 3.589301959624259*^9, 3.589304816881259*^9, 
  3.589304848283259*^9, 3.589305369152259*^9, 3.5893073014813633`*^9, 
  3.5893484671674333`*^9, 3.5893840380010324`*^9, 3.589396849766082*^9, 
  3.5894670913714437`*^9, 3.5894822014693427`*^9, 3.589482277793975*^9, 
  3.589513799873417*^9, 3.589515126587417*^9, 3.589528041113105*^9, 
  3.589528736390625*^9, 3.589788454334111*^9, 3.5897885621491113`*^9, 
  3.589792296778821*^9, 3.5898685269719753`*^9, 3.596441265445071*^9, 
  3.596482568733925*^9, 3.598065455118847*^9, 3.5980980012191296`*^9, 
  3.5981960715166903`*^9, 3.5981969149059744`*^9, 3.6110286372620173`*^9, 
  3.611029905363089*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589217941009054*^9, 3.589217985921117*^9, 
  3.5892231905613623`*^9, 3.5892253482585297`*^9, 3.589225614773982*^9, 
  3.589299187586443*^9, 3.589301959624259*^9, 3.589304816881259*^9, 
  3.589304848283259*^9, 3.589305369152259*^9, 3.5893073014813633`*^9, 
  3.5893484671674333`*^9, 3.5893840380010324`*^9, 3.589396849766082*^9, 
  3.5894670913714437`*^9, 3.5894822014693427`*^9, 3.589482277793975*^9, 
  3.589513799873417*^9, 3.589515126587417*^9, 3.589528041113105*^9, 
  3.589528736390625*^9, 3.589788454334111*^9, 3.5897885621491113`*^9, 
  3.589792296778821*^9, 3.5898685269719753`*^9, 3.596441265445071*^9, 
  3.596482568733925*^9, 3.598065455118847*^9, 3.5980980012191296`*^9, 
  3.5981960715166903`*^9, 3.5981969149059744`*^9, 3.6110286372620173`*^9, 
  3.611029905364513*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SixJSymbol", "::", "tri"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(SixJSymbol[\\(\\(\\(\\({1, 3, 1}\\)\\), \
\\(\\({3\\/2, 1\\/2, 3\\/2}\\)\\)\\)\\)]\\)\[NoBreak] is not triangular. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/SixJSymbol\\\", ButtonNote -> \
\\\"SixJSymbol::tri\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{3.5892179859185247`*^9, 3.589223190558688*^9, 
  3.589225348242075*^9, 3.589225614772914*^9, 3.5892991875834427`*^9, 
  3.589301959620259*^9, 3.589304816879259*^9, 3.5893048482812586`*^9, 
  3.5893053691512585`*^9, 3.5893073014773626`*^9, 3.5893484671674333`*^9, 
  3.5893840379910326`*^9, 3.589396849766082*^9, 3.5894670913714437`*^9, 
  3.589482201467343*^9, 3.5894822777929745`*^9, 3.589513799870417*^9, 
  3.5895151265854173`*^9, 3.5895280411111045`*^9, 3.589528736390625*^9, 
  3.5897884543321114`*^9, 3.5897885621481113`*^9, 3.589792296776821*^9, 
  3.589868526959974*^9, 3.596441265435072*^9, 3.596482568731925*^9, 
  3.598065455114847*^9, 3.5980980012181296`*^9, 3.5981960715166903`*^9, 
  3.5981969149059744`*^9, 3.611028637260767*^9, 3.611029905418715*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1"}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589217941009054*^9, 3.589217985921117*^9, 
  3.5892231905613623`*^9, 3.5892253482585297`*^9, 3.589225614773982*^9, 
  3.589299187586443*^9, 3.589301959624259*^9, 3.589304816881259*^9, 
  3.589304848283259*^9, 3.589305369152259*^9, 3.5893073014813633`*^9, 
  3.5893484671674333`*^9, 3.5893840380010324`*^9, 3.589396849766082*^9, 
  3.5894670913714437`*^9, 3.5894822014693427`*^9, 3.589482277793975*^9, 
  3.589513799873417*^9, 3.589515126587417*^9, 3.589528041113105*^9, 
  3.589528736390625*^9, 3.589788454334111*^9, 3.5897885621491113`*^9, 
  3.589792296778821*^9, 3.5898685269719753`*^9, 3.596441265445071*^9, 
  3.596482568733925*^9, 3.598065455118847*^9, 3.5980980012191296`*^9, 
  3.5981960715166903`*^9, 3.5981969149059744`*^9, 3.6110286372620173`*^9, 
  3.611029905419731*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Branching ratios; ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", " ", 
     SubscriptBox["s", 
      RowBox[{"1", "/", "2"}]]}], " ", "\[Rule]", 
    RowBox[{"5", 
     SubscriptBox["p", 
      RowBox[{"3", "/", "2"}]]}]}], TraditionalForm]]]
}], "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5892230682215137`*^9, 3.589223128043684*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"djj", "[", 
       RowBox[{
        FractionBox["1", "2"], ",", "1", ",", "0", ",", 
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"]}], "]"}], "2"], 
     SuperscriptBox[
      RowBox[{"dff", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        FractionBox["3", "2"], ",", 
        FractionBox["1", "2"], ",", "fg", ",", "fe"}], "]"}], "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"fg", ",", "0", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"fe", ",", "1", ",", "2"}], "}"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589191347196857*^9, 3.589191415996423*^9}, {
  3.589191475298015*^9, 3.589191485743608*^9}, {3.5891915214147863`*^9, 
  3.589191566629966*^9}, {3.589218160817266*^9, 3.589218197387289*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SixJSymbol", "::", "tri"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(SixJSymbol[\\(\\(\\(\\({0, 2, 1}\\)\\), \
\\(\\({1\\/2, 3\\/2, 3\\/2}\\)\\)\\)\\)]\\)\[NoBreak] is not triangular. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/SixJSymbol\\\", ButtonNote -> \
\\\"SixJSymbol::tri\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{{3.589191556600732*^9, 3.589191567990803*^9}, 
   3.5892176697669773`*^9, 3.589218199762266*^9, 3.589223190641666*^9, 
   3.5892253484665117`*^9, 3.5892256148078747`*^9, 3.589299187650443*^9, 
   3.5893019596872587`*^9, 3.5893048169602585`*^9, 3.5893048483512588`*^9, 
   3.589305369231259*^9, 3.5893073015933743`*^9, 3.589348467387407*^9, 
   3.5893840382110324`*^9, 3.5893968498360786`*^9, 3.589467091465044*^9, 
   3.58948220153535*^9, 3.5894822778459797`*^9, 3.5895137999474173`*^9, 
   3.589515126652417*^9, 3.589528041314125*^9, 3.589528736625*^9, 
   3.589788454545111*^9, 3.5897885623891115`*^9, 3.5897922968518286`*^9, 
   3.5898685270219803`*^9, 3.5964412656650515`*^9, 3.5964825688159246`*^9, 
   3.598065455404847*^9, 3.5980980014431295`*^9, 3.5981960717466955`*^9, 
   3.598196915125983*^9, 3.611028637434867*^9, 3.611029905488781*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SixJSymbol", "::", "tri"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(SixJSymbol[\\(\\(\\(\\({3, 1, 1}\\)\\), \
\\(\\({1\\/2, 3\\/2, 3\\/2}\\)\\)\\)\\)]\\)\[NoBreak] is not triangular. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/SixJSymbol\\\", ButtonNote -> \
\\\"SixJSymbol::tri\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{{3.589191556600732*^9, 3.589191567990803*^9}, 
   3.5892176697669773`*^9, 3.589218199762266*^9, 3.589223190641666*^9, 
   3.5892253484665117`*^9, 3.5892256148078747`*^9, 3.589299187650443*^9, 
   3.5893019596872587`*^9, 3.5893048169602585`*^9, 3.5893048483512588`*^9, 
   3.589305369231259*^9, 3.5893073015933743`*^9, 3.589348467387407*^9, 
   3.5893840382110324`*^9, 3.5893968498360786`*^9, 3.589467091465044*^9, 
   3.58948220153535*^9, 3.5894822778459797`*^9, 3.5895137999474173`*^9, 
   3.589515126652417*^9, 3.589528041314125*^9, 3.589528736625*^9, 
   3.589788454545111*^9, 3.5897885623891115`*^9, 3.5897922968518286`*^9, 
   3.5898685270219803`*^9, 3.5964412656650515`*^9, 3.5964825688159246`*^9, 
   3.598065455404847*^9, 3.5980980014431295`*^9, 3.5981960717466955`*^9, 
   3.598196915125983*^9, 3.611028637434867*^9, 3.611029905566655*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     FractionBox["1", "9"], "0"},
    {
     FractionBox["5", "18"], 
     FractionBox["1", "30"]},
    {
     FractionBox["5", "18"], 
     FractionBox["1", "6"]},
    {"0", 
     FractionBox["7", "15"]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.58919155660469*^9, 3.589191567996811*^9}, 
   3.5892176697707367`*^9, 3.5892181997675877`*^9, 3.589223190644183*^9, 
   3.5892253485185823`*^9, 3.589225614809784*^9, 3.589299187687443*^9, 
   3.589301959725259*^9, 3.5893048169792585`*^9, 3.5893048483732586`*^9, 
   3.5893053692552586`*^9, 3.5893073016423793`*^9, 3.5893484674973936`*^9, 
   3.5893840383210325`*^9, 3.589396849886077*^9, 3.589467091511844*^9, 
   3.589482201567353*^9, 3.5894822778759828`*^9, 3.5895137999714174`*^9, 
   3.589515126678417*^9, 3.5895280414391375`*^9, 3.58952873671875*^9, 
   3.589788454651111*^9, 3.5897885624981112`*^9, 3.5897922968988333`*^9, 
   3.589868527039982*^9, 3.596441265785041*^9, 3.5964825688749247`*^9, 
   3.598065455456847*^9, 3.5980980015531297`*^9, 3.5981960718766975`*^9, 
   3.5981969152359877`*^9, 3.611028637573976*^9, 3.611029905567871*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Radial matrix elements for 5p3/2 to ns transition", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5874648043149943`*^9, 3.5874648093149443`*^9}, {
  3.5874650918326654`*^9, 3.5874650996725087`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nmax", "=", "100"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5877153975912523`*^9, 3.587715399380252*^9}}],

Cell[BoxData["100"], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.587989942230934*^9, 3.5880596482143445`*^9, 3.588061175690077*^9, 
   3.5880613059020967`*^9, 3.58806181968647*^9, 3.588062008085308*^9, 
   3.5880623083903356`*^9, 3.588062410570553*^9, 3.588062460416537*^9, 
   3.588062734015894*^9, 3.5880635651179957`*^9, 3.588309948038274*^9, 
   3.588320103798603*^9, 3.5883205525416536`*^9, 3.588320791166193*^9, 
   3.588391979776148*^9, 3.588392016327148*^9, 3.588392076650148*^9, 
   3.5885224202412252`*^9, 3.588527818870961*^9, 3.5885650782586093`*^9, 
   3.5885769089931417`*^9, 3.588581542737052*^9, 3.588603525478963*^9, 
   3.5886528121151896`*^9, 3.588928069859375*^9, 3.588928345421875*^9, 
   3.588928554796875*^9, 3.5890893555*^9, {3.5891204388125*^9, 
   3.58912044409375*^9}, 3.5893002629672585`*^9, 3.589300521171259*^9, 
   3.589301959758259*^9, 3.5893048170192585`*^9, 3.589304848403259*^9, 
   3.589305369289259*^9, 3.589307301681383*^9, 3.58934846752739*^9, 
   3.5893840383510323`*^9, 3.5893968499160757`*^9, 3.589467091543044*^9, 
   3.5894822015963554`*^9, 3.589482277901985*^9, 3.5895138000114174`*^9, 
   3.589515126708417*^9, 3.58952804156815*^9, 3.589528736765625*^9, 
   3.589788454678111*^9, 3.589788562522111*^9, 3.589792296935837*^9, 
   3.589868527103988*^9, 3.5964412658150377`*^9, 3.5964825689169245`*^9, 
   3.5980654554738474`*^9, 3.5980980016481295`*^9, 3.5981960719166985`*^9, 
   3.5981969152559886`*^9, 3.611028637684259*^9, 3.611029905597012*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{
    RowBox[{"n_", "?", "NumericQ"}], ",", 
    RowBox[{"l_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Delta]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"h", "=", "0.01"}], ";", 
    RowBox[{"rs", "=", 
     RowBox[{"3", 
      SuperscriptBox["nmax", "2"]}]}], ";", 
    RowBox[{"nr", "=", 
     RowBox[{"Round", "[", 
      RowBox[{
       FractionBox["1.55", "h"], 
       RowBox[{"Log", "[", "rs", "]"}]}], "]"}]}], ";", 
    RowBox[{"rnum", "=", 
     RowBox[{"rs", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "h"}], " ", 
        RowBox[{"Range", "[", 
         RowBox[{"nr", "+", "1"}], "]"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T", "[", "x_", "]"}], "=", 
     RowBox[{
      FractionBox[
       SuperscriptBox["h", "2"], "12"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2.0", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"2.0", "x"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], 
            RowBox[{"Exp", "[", "x", "]"}]], "-", 
           FractionBox[
            RowBox[{"-", "1"}], 
            RowBox[{"2", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Delta]"}], ")"}], "2"]}]]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"l", "+", 
           FractionBox["1.", "2"]}], ")"}], "2"]}], ")"}]}]}], ";", 
    RowBox[{"x", "=", 
     RowBox[{"Log", "[", "rs", "]"}]}], ";", 
    RowBox[{"old", "=", " ", 
     SuperscriptBox["10.0", 
      RowBox[{"-", "10"}]]}], ";", 
    RowBox[{"cl", "=", 
     RowBox[{"N", "[", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "\[Delta]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"n", "-", "\[Delta]", "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n", "-", "\[Delta]"}], ")"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "0.5"}], ")"}], "2"]}]]}], ")"}]}], "]"}], 
      "]"}]}], ";", "\n", "\[IndentingNewLine]", 
    RowBox[{"nonorm", "=", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "-=", "h"}], ";", 
          RowBox[{"new", "=", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"10", 
                 RowBox[{"T", "[", "x", "]"}]}]}], ")"}], "#"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"x", "+", "h"}], "]"}], "-", "1"}], ")"}], "old"}]}], 
            RowBox[{"1", "-", 
             RowBox[{"T", "[", 
              RowBox[{"x", "-", "h"}], "]"}]}]]}], ";", 
          RowBox[{"old", "=", "#"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "<", "cl"}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", "new", "]"}], ">", 
              RowBox[{"Abs", "[", "old", "]"}]}]}], ",", "0.", ",", "new"}], 
           "]"}]}], ")"}], "&"}], ",", 
       RowBox[{"1.1", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "10"}]]}], ",", "nr"}], "]"}]}], ";", 
    FractionBox[
     RowBox[{
      SqrtBox["rnum"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"n", "+", "l", "+", "1"}]], " ", "nonorm"}], 
     RowBox[{" ", 
      RowBox[{
       SqrtBox["h"], 
       RowBox[{"Norm", "[", 
        RowBox[{"nonorm", " ", "rnum"}], "]"}]}]}]]}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4277067294507*^9, 3.427706733074678*^9}, {
   3.42770790754508*^9, 3.427707922948803*^9}, {3.4277081693150187`*^9, 
   3.427708176816832*^9}, {3.427708379641773*^9, 3.427708411110352*^9}, {
   3.4277085134585657`*^9, 3.427708522118128*^9}, {3.427708572185101*^9, 
   3.427708576799007*^9}, {3.427708695512856*^9, 3.4277087511055098`*^9}, {
   3.427708782942498*^9, 3.427708783230707*^9}, {3.4277088218157663`*^9, 
   3.42770882573284*^9}, {3.427708911745422*^9, 3.4277089398067083`*^9}, 
   3.427709621383872*^9, 3.427709665690282*^9, {3.427715761932392*^9, 
   3.427715773097282*^9}, {3.427716308667926*^9, 3.427716334771634*^9}, 
   3.427716385307753*^9, {3.427716549467846*^9, 3.427716562009776*^9}, {
   3.4277166355307503`*^9, 3.4277167018083143`*^9}, 3.427716980951808*^9, {
   3.4277172435721493`*^9, 3.427717244699016*^9}, {3.4277173129069557`*^9, 
   3.427717384651079*^9}, 3.427717769903157*^9, {3.427717948739695*^9, 
   3.4277179504292593`*^9}, {3.4277180328720913`*^9, 
   3.4277180713850107`*^9}, {3.427719102326606*^9, 3.427719119533161*^9}, {
   3.427719510186014*^9, 3.427719512971274*^9}, {3.4277195835028563`*^9, 
   3.427719587055263*^9}, {3.427719677148878*^9, 3.427719677949479*^9}, {
   3.427719708904859*^9, 3.427719713429451*^9}, {3.427733652266027*^9, 
   3.427733702190589*^9}, {3.427733764729701*^9, 3.427733765290715*^9}, 
   3.4277352326886177`*^9, 3.4277353075311832`*^9, 3.427735412332327*^9, 
   3.4277356115764923`*^9, {3.427735675470119*^9, 3.427735676129722*^9}, 
   3.42773584783331*^9, 3.427735947530946*^9, {3.427735983361854*^9, 
   3.427735984273795*^9}, {3.517547934195641*^9, 3.517547934403174*^9}, {
   3.517550314938424*^9, 3.517550345673976*^9}, {3.517550644155732*^9, 
   3.517550668114007*^9}, {3.517551769204892*^9, 3.517551769468351*^9}, {
   3.517569344601831*^9, 3.517569404316592*^9}, {3.5175694429532022`*^9, 
   3.517569472217416*^9}, {3.517761265245263*^9, 3.517761285974368*^9}, {
   3.517761322581599*^9, 3.5177613928753757`*^9}, {3.517761710173972*^9, 
   3.517761711822209*^9}, {3.517761800681278*^9, 3.517761801729788*^9}, {
   3.51776261878881*^9, 3.517762623577704*^9}, {3.517764281888496*^9, 
   3.517764283279798*^9}, {3.5177647804686813`*^9, 3.51776478460921*^9}, {
   3.5178082394324417`*^9, 3.517808252520179*^9}, {3.518158782430727*^9, 
   3.518158783494494*^9}, {3.5181589125877447`*^9, 3.518158966405056*^9}, {
   3.5181590561690397`*^9, 3.518159088729856*^9}, {3.518159455761855*^9, 
   3.518159465558896*^9}, {3.5181595188678207`*^9, 3.518159519725296*^9}, {
   3.518160737894484*^9, 3.518160738588894*^9}, {3.518161118106709*^9, 
   3.518161119448407*^9}, {3.518161181350576*^9, 3.5181611985340223`*^9}, {
   3.518161300826127*^9, 3.518161301697124*^9}, {3.518167381923934*^9, 
   3.5181673877296677`*^9}, {3.5782914383724155`*^9, 3.578291439591158*^9}, 
   3.5786333618898067`*^9, {3.578633681115196*^9, 3.578633684943248*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]", "[", 
   RowBox[{
    RowBox[{"n_", "?", "NumericQ"}], ",", "0", ",", 
    RowBox[{"j_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"3.1311804", "+", 
   FractionBox["0.1784", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"n", "-", "3.1311804"}], ")"}], "2"]]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Delta]", "[", 
   RowBox[{
    RowBox[{"n_", "?", "NumericQ"}], ",", "1", ",", 
    RowBox[{"j_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "\[Equal]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{"2.6548849", "+", 
     FractionBox["0.2900", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"n", "-", "2.6548849"}], ")"}], "2"]]}], ",", 
    RowBox[{"2.6416737", "+", 
     FractionBox["0.2950", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"n", "-", "2.6416737"}], ")"}], "2"]]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "[", 
   RowBox[{
    RowBox[{"n_", "?", "NumericQ"}], ",", 
    RowBox[{"l_", "?", "NumericQ"}], ",", 
    RowBox[{"j_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", "l"}], ")"}], 
   SuperscriptBox["10", 
    RowBox[{"-", "10.0"}]]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.430495801965166*^9, 3.430495845836288*^9}, {
   3.51463217721264*^9, 3.514632193923682*^9}, {3.514791642368479*^9, 
   3.514791683201634*^9}, 3.5783907481539454`*^9, {3.578633391185557*^9, 
   3.578633391498045*^9}, {3.587466053289961*^9, 3.5874660552799416`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RadialMatrixElement", "[", "n_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nmax", "=", "n"}], "}"}], ",", 
    RowBox[{"Abs", "[", 
     RowBox[{"h", " ", 
      RowBox[{"Total", "[", " ", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"5", ",", "1", ",", 
          RowBox[{"\[Delta]", "[", 
           RowBox[{"5", ",", "1", ",", 
            FractionBox["3", "2"]}], "]"}]}], "]"}], 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"n", ",", "0", ",", 
          RowBox[{"\[Delta]", "[", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], 
        SuperscriptBox["rnum", "2"]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587463725064786*^9, 3.587463780274234*^9}, {
   3.587463825213784*^9, 3.5874638726633096`*^9}, {3.5874639361026754`*^9, 
   3.5874639482625537`*^9}, {3.5874644367166705`*^9, 3.587464460276435*^9}, {
   3.587464689695141*^9, 3.5874647101359367`*^9}, {3.587464922200398*^9, 
   3.5874649846848087`*^9}, {3.587465023254037*^9, 3.5874650551333995`*^9}, 
   3.587713851640252*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Rabi-frequencies in MHz (quantities to be given in SI units)", \
"Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5874589688750305`*^9, 3.587458972824952*^9}, {
   3.587459082372761*^9, 3.587459084362721*^9}, 3.587459302181363*^9, {
   3.5874617840611687`*^9, 3.587461805700736*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5874617034317813`*^9, 3.587461768541479*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RabiFrequency", "[", 
   RowBox[{"n2_", ",", "Pow_", ",", "waist_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"n2", "\[Equal]", "5"}], ",", 
    RowBox[{
     RowBox[{"2", "*", 
      SqrtBox[
       RowBox[{"P", "/", 
        RowBox[{"(", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", "8"], "*", "8.854", "*", 
          SuperscriptBox["10", 
           RowBox[{"\[IndentingNewLine]", 
            RowBox[{"-", "12"}]}]], "*", "\[Pi]", "*", 
          SuperscriptBox["w", "2"]}], ")"}]}]], "*", "5.29", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], "*", "1.602", "*", 
      RowBox[{
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "19"}]], " ", "/", 
        RowBox[{"(", 
         RowBox[{"1.054571", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "34"}]]}], ")"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}]}], "*", 
      RowBox[{"5.18", "/", 
       SuperscriptBox["10", "6"]}]}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "\[Rule]", "Pow"}], ",", 
       RowBox[{"w", "\[Rule]", "waist"}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"2", "*", 
      SqrtBox[
       RowBox[{"P", "/", 
        RowBox[{"(", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", "8"], "*", "8.854", "*", 
          SuperscriptBox["10", 
           RowBox[{"\[IndentingNewLine]", 
            RowBox[{"-", "12"}]}]], "*", "\[Pi]", "*", 
          SuperscriptBox["w", "2"]}], ")"}]}]], "*", "5.29", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], "*", "1.602", "*", 
      RowBox[{
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "19"}]], " ", "/", 
        RowBox[{"(", 
         RowBox[{"1.054571", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "34"}]]}], ")"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"RadialMatrixElement", "[", "n2", "]"}], "/", 
       SuperscriptBox["10", "6"]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "\[Rule]", "Pow"}], ",", 
       RowBox[{"w", "\[Rule]", "waist"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587460898070783*^9, 3.5874609385099745`*^9}, {
   3.58746097437836*^9, 3.5874610530767856`*^9}, {3.5874610876860933`*^9, 
   3.5874610967969112`*^9}, {3.587461135316141*^9, 3.5874611388860693`*^9}, {
   3.5874611901050453`*^9, 3.5874612579836874`*^9}, {3.587461753281784*^9, 
   3.587461777431301*^9}, {3.5874618888690724`*^9, 3.5874619332481847`*^9}, {
   3.5874619788672724`*^9, 3.587461995836933*^9}, {3.5874651140122223`*^9, 
   3.5874651681721387`*^9}, {3.587465213251237*^9, 3.5874652169111643`*^9}, 
   3.587465247780546*^9, {3.5874652794299135`*^9, 3.5874652873497553`*^9}, {
   3.5874653369897623`*^9, 3.587465340899684*^9}, {3.587465465427973*^9, 
   3.587465500017897*^9}, {3.5874656255571465`*^9, 3.5874656805870285`*^9}, {
   3.5874657413168726`*^9, 3.587465760326682*^9}, {3.5874657942710276`*^9, 
   3.587465855600857*^9}, {3.587716838524252*^9, 3.587716840212252*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RabiFrequency", "[", 
  RowBox[{"5", ",", 
   RowBox[{"15", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}], ",", 
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5874618096806564`*^9, 3.587461850059849*^9}, {
   3.587465231880864*^9, 3.5874652357207875`*^9}, 3.587465348339535*^9, 
   3.5874654422070084`*^9, {3.5874657457168283`*^9, 3.5874657458868265`*^9}, {
   3.5874658355700274`*^9, 3.587465869360016*^9}, {3.587713867774252*^9, 
   3.587713874574252*^9}, {3.5877168430232525`*^9, 3.587716843951252*^9}, {
   3.589300350860259*^9, 3.5893003626672587`*^9}}],

Cell[BoxData["5.617751876594858`"], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.5879899423349447`*^9, {3.5880596524437675`*^9, 3.588059654688992*^9}, 
   3.588061175782086*^9, 3.588061306012108*^9, 3.5880618197874804`*^9, 
   3.588062008185318*^9, 3.5880623085803547`*^9, 3.588062410678563*^9, 
   3.588062460519547*^9, 3.5880627341059027`*^9, 3.5880635652050047`*^9, 
   3.5883099480882673`*^9, 3.588320103868601*^9, 3.58832055262165*^9, 
   3.588320791286189*^9, 3.588391982208148*^9, 3.588392016404148*^9, 
   3.588392076718148*^9, 3.5885224203192253`*^9, 3.5885278189489613`*^9, 
   3.5885650783056135`*^9, 3.5885769090361414`*^9, 3.588581542806052*^9, 
   3.588603525816929*^9, 3.5886528121751847`*^9, 3.5889280699375*^9, 
   3.588928345515625*^9, 3.588928554859375*^9, 3.5890893555625*^9, {
   3.589120438875*^9, 3.58912044415625*^9}, 3.5893002672992587`*^9, {
   3.589300353664259*^9, 3.5893003632882586`*^9}, 3.5893005239242587`*^9, 
   3.5893007988732586`*^9, 3.5893019598382587`*^9, 3.589304817119259*^9, 
   3.589304848499259*^9, 3.5893053693852587`*^9, 3.589307301762391*^9, 
   3.589348467577384*^9, 3.5893840384110327`*^9, 3.589396850006072*^9, 
   3.5894670916834445`*^9, 3.5894822016833644`*^9, 3.5894822779719925`*^9, 
   3.589513800097417*^9, 3.5895151267764173`*^9, 3.589528042536247*^9, 
   3.589528736921875*^9, 3.5897884547381115`*^9, 3.589788562571111*^9, 
   3.5897922970348463`*^9, 3.589868527272005*^9, 3.5964412659450264`*^9, 
   3.5964825690709248`*^9, 3.598065455509847*^9, 3.5980980016951294`*^9, 
   3.5981960719767*^9, 3.59819691529599*^9, 3.6110286379003067`*^9, 
   3.6110299057458153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RabiFrequency", "[", 
  RowBox[{"20", ",", 
   RowBox[{"200", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}], ",", 
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589300275065259*^9, 3.589300323278259*^9}}],

Cell[BoxData["7.841075423917192`"], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.589300275798259*^9, {3.589300309938259*^9, 3.589300324087259*^9}, 
   3.589300524034259*^9, 3.5893007989862585`*^9, 3.589301959949259*^9, 
   3.5893048172432585`*^9, 3.589304848626259*^9, 3.589305369502259*^9, 
   3.5893073018974047`*^9, 3.589348467737365*^9, 3.5893840385310326`*^9, 
   3.589396850156066*^9, 3.589467091855045*^9, 3.5894822018143773`*^9, 
   3.5894822780800033`*^9, 3.589513800211417*^9, 3.5895151268944173`*^9, 
   3.5895280426602592`*^9, 3.5895287371875*^9, 3.5897884549761114`*^9, 
   3.589788562704111*^9, 3.5897922971998634`*^9, 3.589868527403018*^9, 
   3.596441266244999*^9, 3.596482569371925*^9, 3.5980654556928473`*^9, 
   3.5980980018931293`*^9, 3.5981960721467032`*^9, 3.598196915395994*^9, 
   3.611028638081649*^9, 3.611029905859867*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bare Hamiltonian, dressed but no couplings", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.523333567609375*^9, 3.523333591828125*^9}, {
  3.588333073253112*^9, 3.588333074588997*^9}, {3.5884023888471937`*^9, 
  3.588402389286331*^9}},
 FontFamily->"Verdana",
 FontSize->14],

Cell[TextData[{
 "States 1-5: F=2, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "F"], TraditionalForm]]],
 "=-2,...,+2 ground states\nStates 6-10: F\[CloseCurlyQuote]=2, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "F"], TraditionalForm]]],
 "=-2,...,+2 intermediate state ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"5", 
     SubscriptBox["P", 
      RowBox[{"3", "/", "2"}]]}], ")"}], TraditionalForm]]],
 "\nStates 11-13: F\[CloseCurlyQuote]\[CloseCurlyQuote]=1, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "F"], TraditionalForm]]],
 "=-1,...,+1 Rydberg states ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["nS", 
     RowBox[{"1", "/", "2"}]], ")"}], TraditionalForm]]],
 " \nStates 14-18: F\[CloseCurlyQuote]\[CloseCurlyQuote]=2, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "F"], TraditionalForm]]],
 "=-2,...,+2 Rydberg states ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["nS", 
     RowBox[{"1", "/", "2"}]], ")"}], TraditionalForm]]]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.52333400128125*^9, 3.5233340729375*^9}, {
  3.58833203271548*^9, 3.588332241228373*^9}, {3.588333086493534*^9, 
  3.588333155679793*^9}},
 FontFamily->"Verdana",
 FontSize->14],

Cell[CellGroupData[{

Cell["\<\
Establish Breit-Rabi-Hamiltonian and put this one into F,mF Basis for Rydberg \
states\
\>", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5897844209953227`*^9, 3.5897844517723227`*^9}, {
  3.589784502365323*^9, 3.5897845047973228`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixElement", "[", 
   RowBox[{"mj_", ",", "mf_", ",", "mj2_", ",", "mf2_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Inuc", "=", 
      RowBox[{"3", "/", "2"}]}], "}"}], ",", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"mf", "\[NotEqual]", "mf2"}], ",", "0", ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", 
      RowBox[{"mj", "\[Equal]", "mj2"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}], "*", "A"}], "+", 
       RowBox[{"mj", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"A", "*", "mf"}], "-", 
          RowBox[{"gJ", "*", "\[Mu]B", "*", "BField"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", 
      RowBox[{"mj", "\[NotEqual]", "mj2"}], ",", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "A", "*", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Inuc", "+", 
            RowBox[{"1", "/", "2"}]}], ")"}], "2"], "-", 
         SuperscriptBox["mf", "2"]}]]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5897760769130373`*^9, 3.5897761795963044`*^9}, {
  3.5897762283821826`*^9, 3.589776230284373*^9}, {3.5897763604743905`*^9, 
  3.589776380355378*^9}, {3.589776422163559*^9, 3.5897764590842505`*^9}, {
  3.589776543268668*^9, 3.5897765515895*^9}, {3.5897766420195346`*^9, 
  3.589776700042535*^9}, {3.5897767469345345`*^9, 3.5897767847215347`*^9}, {
  3.5897768559495344`*^9, 3.5897768784445343`*^9}, {3.5897773290395346`*^9, 
  3.589777536554535*^9}, {3.5897776098295345`*^9, 3.5897776284785347`*^9}, {
  3.5897799022723694`*^9, 3.5897799099893694`*^9}, {3.5897843186473227`*^9, 
  3.5897843311023226`*^9}},
 FontSize->16],

Cell["Hamiltonian in mJ,mI Basis", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.589784542818323*^9, 3.5897845582343225`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"states", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mj", ",", "mI"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mj", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mI", ",", 
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}], ",", 
        RowBox[{"3", "/", "2"}], ",", "1"}], "}"}]}], "]"}], ",", "1"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5897791174227233`*^9, 3.5897792446524453`*^9}, {
   3.5897793696499434`*^9, 3.589779374033382*^9}, 3.5897798187033696`*^9, 
   3.5897805336903696`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["3", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", 
     FractionBox["1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", 
     FractionBox["3", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     RowBox[{"-", 
      FractionBox["3", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["3", "2"]}], "}"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589784823969762*^9, 3.5897884552851114`*^9, 
  3.589788562777111*^9, 3.589792297558899*^9, 3.5898685274470224`*^9, 
  3.5964412662849956`*^9, 3.596482569486925*^9, 3.598065455710847*^9, 
  3.5980980020021296`*^9, 3.5981960722567053`*^9, 3.5981969154159946`*^9, 
  3.611028638135785*^9, 3.611029905929955*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"breitRabi", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mj", "=", 
          RowBox[{
           RowBox[{
           "states", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"mI", "=", 
          RowBox[{
           RowBox[{
           "states", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"mj2", "=", 
          RowBox[{
           RowBox[{
           "states", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"mI2", "=", 
          RowBox[{
           RowBox[{
           "states", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}], 
       ",", 
       RowBox[{"MatrixElement", "[", 
        RowBox[{"mj", ",", 
         RowBox[{"mj", "+", "mI"}], ",", "mj2", ",", 
         RowBox[{"mj2", "+", "mI2"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5897777077115345`*^9, 3.5897777179345345`*^9}, 
   3.5897778667965345`*^9, {3.5897783198525343`*^9, 3.5897783520455346`*^9}, {
   3.589778396858535*^9, 3.5897784460995345`*^9}, {3.5897786440043864`*^9, 
   3.5897786586328487`*^9}, 3.589778705314517*^9, 3.5897798058403697`*^9, {
   3.5897844847533226`*^9, 3.5897844877053227`*^9}, 3.5897847127483225`*^9},
 FontSize->16],

Cell["Establish change of Basis-Matrix for F,mF to mj,mI", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.589784598138323*^9, 3.5897846242223225`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FBasis", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"-", "i"}], ",", "i"}], "}"}]}], "]"}], ",", "1"}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.589784827330098*^9, 3.5897884553441114`*^9, 
  3.589788562852111*^9, 3.589792297726916*^9, 3.5898685274900265`*^9, 
  3.59644126634599*^9, 3.596482569583925*^9, 3.5980654557288475`*^9, 
  3.5980980020331297`*^9, 3.598196072286706*^9, 3.598196915435996*^9, 
  3.611028638183568*^9, 3.611029905997754*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FtoMs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F", "=", 
          RowBox[{
           RowBox[{
           "FBasis", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"mF", "=", 
          RowBox[{
           RowBox[{
           "FBasis", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"mj", "=", 
          RowBox[{
           RowBox[{
           "states", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"mI", "=", 
          RowBox[{
           RowBox[{
           "states", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}], 
       ",", 
       RowBox[{"ClebschGordan", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "mj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "/", "2"}], ",", "mI"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"F", ",", "mF"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ClebschGordan", "::", "phy"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(ThreeJSymbol[\\(\\(\\(\\({1\\/2, \
\\(\\(-\\(\\(1\\/2\\)\\)\\)\\)}\\)\\), \\(\\({3\\/2, \\(\\(-\\(\\(3\\/2\\)\\)\
\\)\\)}\\)\\), \\(\\({1, 1}\\)\\)\\)\\)]\\)\[NoBreak] is not physical. \\!\\(\
\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ClebschGordan/phy\\\", \
ButtonNote -> \\\"ClebschGordan::phy\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{3.5897848286842337`*^9, 3.5897884554381113`*^9, 
  3.589788562940111*^9, 3.5897922978439274`*^9, 3.589868527551033*^9, 
  3.596441266445981*^9, 3.5964825697289248`*^9, 3.5980654557758474`*^9, 
  3.5980980020841293`*^9, 3.5981960723467073`*^9, 3.598196915485998*^9, 
  3.6110286382466097`*^9, 3.611029906031193*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ClebschGordan", "::", "phy"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(ThreeJSymbol[\\(\\(\\(\\({1\\/2, \
\\(\\(-\\(\\(1\\/2\\)\\)\\)\\)}\\)\\), \\(\\({3\\/2, 1\\/2}\\)\\), \\(\\({1, \
1}\\)\\)\\)\\)]\\)\[NoBreak] is not physical. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ClebschGordan/phy\\\", ButtonNote -> \
\\\"ClebschGordan::phy\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{3.5897848286842337`*^9, 3.5897884554381113`*^9, 
  3.589788562940111*^9, 3.5897922978439274`*^9, 3.589868527551033*^9, 
  3.596441266445981*^9, 3.5964825697289248`*^9, 3.5980654557758474`*^9, 
  3.5980980020841293`*^9, 3.5981960723467073`*^9, 3.598196915485998*^9, 
  3.6110286382466097`*^9, 3.611029906063691*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ClebschGordan", "::", "phy"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(ThreeJSymbol[\\(\\(\\(\\({1\\/2, \
\\(\\(-\\(\\(1\\/2\\)\\)\\)\\)}\\)\\), \\(\\({3\\/2, 3\\/2}\\)\\), \\(\\({1, \
1}\\)\\)\\)\\)]\\)\[NoBreak] is not physical. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ClebschGordan/phy\\\", ButtonNote -> \
\\\"ClebschGordan::phy\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{3.5897848286842337`*^9, 3.5897884554381113`*^9, 
  3.589788562940111*^9, 3.5897922978439274`*^9, 3.589868527551033*^9, 
  3.596441266445981*^9, 3.5964825697289248`*^9, 3.5980654557758474`*^9, 
  3.5980980020841293`*^9, 3.5981960723467073`*^9, 3.598196915485998*^9, 
  3.6110286382466097`*^9, 3.6110299060977373`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(ClebschGordan :: \
phy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 InitializationCell->True,
 CellChangeTimes->{3.5897848286842337`*^9, 3.5897884554381113`*^9, 
  3.589788562940111*^9, 3.5897922978439274`*^9, 3.589868527551033*^9, 
  3.596441266445981*^9, 3.5964825697289248`*^9, 3.5980654557758474`*^9, 
  3.5980980020841293`*^9, 3.5981960723467073`*^9, 3.598196915485998*^9, 
  3.6110286382466097`*^9, 3.611029906099908*^9}]
}, Open  ]],

Cell["Transform Hamiltonian into that basis", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.589784797177083*^9, 3.5897848085052156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hamFBasis", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"FtoMs", ".", "breitRabi", ".", 
     RowBox[{"FtoMs", "\[Transpose]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"hamFBasis", "/.", 
    RowBox[{"{", 
     RowBox[{"BField", "\[Rule]", "1"}], "}"}]}], "//", 
   "MatrixForm"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5897848637887435`*^9, 3.5897848777811427`*^9}, {
   3.589792256554799*^9, 3.589792257785922*^9}, 3.5964412774149942`*^9, 
   3.5964445673029675`*^9, 3.596447106917241*^9, {3.5964471764803257`*^9, 
   3.596447184688326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eig", "[", "x_", "]"}], ":=", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"hamFBasis", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BField", "\[Rule]", "x"}], ",", 
       RowBox[{"A", "\[Rule]", "7"}], ",", 
       RowBox[{"gJ", "\[Rule]", "2"}], ",", 
       RowBox[{"gg", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", 
       RowBox[{"gp", "\[Rule]", 
        RowBox[{"2", "/", "3"}]}], ",", 
       RowBox[{"\[Mu]B", "\[Rule]", "1.4"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.596442688801871*^9, 3.5964427156997185`*^9}, {
  3.5964428097121973`*^9, 3.5964428099621773`*^9}, {3.596442910744114*^9, 
  3.596442946841226*^9}, {3.596443042873543*^9, 3.596443070171359*^9}, {
  3.5964431599058714`*^9, 3.5964431657054653`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hfList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"19", ",", "9.345"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "7.769"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21", ",", "6.409"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"22", ",", "5.431"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"23", ",", "4.701"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"24", ",", "4.182"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"25", ",", "3.667"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "3.356"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"27", ",", "2.991"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "2.551"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5879834808287477`*^9, 3.587983484892748*^9}, {
  3.5879835288497477`*^9, 3.5879835386087475`*^9}, {3.587983622027748*^9, 
  3.5879836806977477`*^9}, {3.587983808183748*^9, 3.587983808439748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findHfs", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"hfList", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "n"}], "&"}]}], "]"}], 
      "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587983709214748*^9, 3.5879837246137476`*^9}, {
  3.587983797831748*^9, 3.5879839002567477`*^9}, {3.5879839312717476`*^9, 
  3.587983935319748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bareMatrix", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\[Mu]B", "*", "gg", "*", "m", "*", "BField"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Mu]B", "*", "gp", "*", "BField", "*", "m"}], "+", 
              "\[Delta]p"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}],
         ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"hamFBasis", "+", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[Delta]p", "+", "\[Delta]c"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}], "]"}]}]}], 
       "}"}]}], "}"}], "]"}]}], ";", 
  RowBox[{"bareMatrix", "//", "MatrixForm"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589787693433111*^9, 3.589787726220111*^9}, {
  3.5897879430761113`*^9, 3.5897879845561113`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"diagEne", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"bareMatrix", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "->", 
      RowBox[{
       RowBox[{"findHfs", "[", "n", "]"}], "/", "2"}]}], ",", 
     RowBox[{"gJ", "\[Rule]", "2"}], ",", 
     RowBox[{"gg", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"gp", "\[Rule]", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"\[Mu]B", "\[Rule]", "1.4"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5874475136515512`*^9, 3.5874476394802933`*^9}, {
   3.587448462291625*^9, 3.5874485200520477`*^9}, {3.587448552931719*^9, 
   3.5874485633716145`*^9}, {3.5874486139411087`*^9, 3.5874486698105497`*^9}, 
   3.587448948257766*^9, {3.5874503200291758`*^9, 3.587450320109174*^9}, {
   3.5874715698480062`*^9, 3.5874715750579543`*^9}, {3.5874716099176054`*^9, 
   3.587471641137294*^9}, {3.5874716971667333`*^9, 3.5874717097366076`*^9}, {
   3.5874717822568827`*^9, 3.587471800096704*^9}, {3.587472451361539*^9, 
   3.587472472460906*^9}, {3.587472742143815*^9, 3.5874727456337104`*^9}, {
   3.5877169705442524`*^9, 3.587716989318252*^9}, {3.587983948623748*^9, 
   3.587983969886748*^9}, {3.5879840720397477`*^9, 3.587984076621748*^9}, 
   3.587984169097748*^9, {3.588320527922638*^9, 3.58832054288204*^9}, {
   3.588391695356148*^9, 3.588391703795148*^9}, {3.5884172806085324`*^9, 
   3.588417298448532*^9}, {3.588423897436036*^9, 3.588423911636894*^9}, 
   3.588577679721142*^9, {3.5895137820494175`*^9, 3.589513790833417*^9}, 
   3.589515018378417*^9, {3.589784963688732*^9, 3.589785000396403*^9}, {
   3.5897853663499947`*^9, 3.589785428049164*^9}, {3.5897860099663496`*^9, 
   3.5897860579361467`*^9}, 3.5897861140507574`*^9, {3.5897862766410146`*^9, 
   3.589786441617511*^9}, {3.58978649812016*^9, 3.5897866066740146`*^9}, {
   3.589786712679614*^9, 3.5897867157749233`*^9}, {3.589786789312111*^9, 
   3.5897868609031115`*^9}, {3.589787444706111*^9, 3.589787495565111*^9}, {
   3.589787595512111*^9, 3.589787621972111*^9}, 3.5897876998251114`*^9, {
   3.589787786249111*^9, 3.589787908569111*^9}, 3.589788009034111*^9, 
   3.589788230388111*^9, {3.5897882684901114`*^9, 3.589788268562111*^9}, {
   3.589788319776111*^9, 3.5897883757051115`*^9}, 3.589788555414111*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rabi drivings", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.588348305865066*^9, 3.58834831838588*^9}, 
   3.58834891209101*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hRp", "[", "q_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", "=", 
      RowBox[{"insert", "[", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"cgtq", "[", 
         RowBox[{"2", ",", "2", ",", "q"}], "]"}], ",", "6", ",", "1"}], 
       "]"}]}], "}"}], ",", 
    RowBox[{
     FractionBox["\[CapitalOmega]p", "2"], 
     RowBox[{"(", 
      RowBox[{"tmp", "+", 
       RowBox[{"tmp", "\[Transpose]"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hRc", "[", "q_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tmp1", "=", 
       RowBox[{"insert", "[", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"cgtq", "[", 
          RowBox[{"2", ",", "1", ",", "q"}], "]"}], ",", "11", ",", "6"}], 
        "]"}]}], ",", 
      RowBox[{"tmp2", "=", 
       RowBox[{"insert", "[", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"cgtq", "[", 
          RowBox[{"2", ",", "2", ",", "q"}], "]"}], ",", "14", ",", "6"}], 
        "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      FractionBox["\[CapitalOmega]r1", "2"], 
      RowBox[{"(", 
       RowBox[{"tmp1", "+", 
        RowBox[{"tmp1", "\[Transpose]"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["\[CapitalOmega]r2", "2"], 
      RowBox[{"(", 
       RowBox[{"tmp2", "+", 
        RowBox[{"tmp2", "\[Transpose]"}]}], ")"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58840089625119*^9, 3.58840094394368*^9}, {
  3.588401051238701*^9, 3.588401110261216*^9}, {3.588401337231819*^9, 
  3.5884013961543837`*^9}, {3.588401596975102*^9, 3.588401680366679*^9}, {
  3.589300577997259*^9, 3.5893005794902587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HMatrix", "[", 
   RowBox[{"qp_", ",", "qc_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"diagEne", "[", "n", "]"}], "+", 
    RowBox[{"hRp", "[", "qp", "]"}], "+", 
    RowBox[{"hRc", "[", "qc", "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalOmega]p", "\[Rule]", "1"}], ",", 
     RowBox[{"\[CapitalOmega]r2", "\[Rule]", "2"}], ",", 
     RowBox[{"\[CapitalOmega]r1", "\[Rule]", "2"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589306164178259*^9, 3.5893061689842587`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lindblad operator, decay terms", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.588351795603077*^9, 3.588351811178501*^9}, {
  3.588400176636589*^9, 3.58840018069485*^9}, {3.5884022656134453`*^9, 
  3.5884022675572367`*^9}, {3.589221656586648*^9, 3.589221659038744*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cp", "[", "q_", "]"}], ":=", 
   RowBox[{"insert", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"cgtq", "[", 
       RowBox[{"2", ",", "2", ",", "q"}], "]"}], "\[Transpose]"}], ",", "1", 
     ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cc1", "[", "q_", "]"}], ":=", 
   RowBox[{"insert", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"cgtq", "[", 
       RowBox[{"2", ",", "1", ",", "q"}], "]"}], "\[Transpose]"}], ",", "6", 
     ",", "11"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cc2", "[", "q_", "]"}], ":=", 
   RowBox[{"insert", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nstates", ",", "nstates"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"cgtq", "[", 
       RowBox[{"2", ",", "2", ",", "q"}], "]"}], "\[Transpose]"}], ",", "6", 
     ",", "14"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.588352861484912*^9, 3.5883529264287977`*^9, {3.588352975693267*^9, 
   3.588352984588786*^9}, {3.58835313898001*^9, 3.588353190740594*^9}, {
   3.5883536844572153`*^9, 3.5883536968665237`*^9}, {3.5883537500511427`*^9, 
   3.5883537563239822`*^9}, {3.588353843966807*^9, 3.588353847404533*^9}, {
   3.588354028852853*^9, 3.588354032754486*^9}, {3.58835414461978*^9, 
   3.588354170432012*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"cp", "[", "q", "]"}], "\[Transpose]"}], ".", 
      RowBox[{"cp", "[", "q", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"cc1", "[", "q", "]"}], "\[Transpose]"}], ".", 
      RowBox[{"cc1", "[", "q", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"cc2", "[", "q", "]"}], "\[Transpose]"}], ".", 
      RowBox[{"cc2", "[", "q", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588498804972715*^9, 3.5884988674454527`*^9}, {
  3.588498912091384*^9, 3.588498971507717*^9}, {3.5885015743476477`*^9, 
  3.588501633276546*^9}, {3.5891886573879843`*^9, 3.5891886594586554`*^9}, {
  3.5892218378186607`*^9, 3.589221930799999*^9}, {3.5892232891827993`*^9, 
  3.5892232956063633`*^9}}],

Cell[TextData[{
 "Hyperfine \[OpenCurlyDoubleQuote]leak\[CloseCurlyDoubleQuote], assuming \
that 50 % of the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"5", 
    SubscriptBox["p", 
     RowBox[{"3", "/", "2"}]]}], TraditionalForm]]],
 " (F' = 2) decays into the dark F = 1 ground state\n",
 "Here we \[OpenCurlyDoubleQuote]hardwire\[CloseCurlyDoubleQuote] in the fact \
that F\[CloseCurlyQuote] = 2 decays to F = 1 and F = 2 with equal probability",
 "\nIn the OBE, the condition Tr(\[Rho])=1 is no longer true, so should be \
removed"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.589175439027018*^9, 3.589175476547207*^9}, {
  3.589175511318151*^9, 3.5891755758579407`*^9}, {3.589221337949647*^9, 
  3.589221338567082*^9}, {3.589223302996605*^9, 3.589223304860182*^9}},
 FontFamily->"Tahoma",
 FontColor->RGBColor[0.01680018310826276, 0.19832150759136338`, 1.]],

Cell["\<\
The approach is to temporarily add a 19th auxiliary level and remove it again \
after constructing the Lindblad term\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.58917559048881*^9, 3.589175659556752*^9}},
 FontFamily->"Tahoma",
 FontColor->RGBColor[0.01680018310826276, 0.19832150759136338`, 1.]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cHF", "[", "i_", "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "i"}], "}"}], "\[Rule]", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "19"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cHF", "[", "1", "]"}], "//", "MatrixForm"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58917448405306*^9, 3.589174534579207*^9}, {
   3.589174769367868*^9, 3.589174791986157*^9}, {3.589174841839645*^9, 
   3.589174866925589*^9}, {3.589174904052388*^9, 3.589174920777617*^9}, {
   3.5891749542595177`*^9, 3.589174958272604*^9}, {3.589175400132916*^9, 
   3.5891754030800123`*^9}, {3.589175932663083*^9, 3.589175951973648*^9}, {
   3.589176005547415*^9, 3.589176006035077*^9}, 3.589221998058465*^9, 
   3.589223271877939*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 "Decay from the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"5", 
    SubscriptBox["p", 
     RowBox[{"3", "/", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "'"}], "=", "2"}], ")"}]}], TraditionalForm]]],
 " level"
}], "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.589221108813805*^9, 3.589221117836988*^9}, {
  3.589222262121834*^9, 3.5892222846458406`*^9}, {3.58922546476079*^9, 
  3.5892254651122723`*^9}}],

Cell["Decay to 5s (F = 1)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892213643684597`*^9, 3.5892213924694023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotp1", "=", 
   RowBox[{
    FractionBox[
     SubscriptBox["\[CapitalGamma]", "p"], "2"], " ", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"d\[Rho]Lindblad", "[", 
         RowBox[{"\[Rho]19", ",", 
          RowBox[{"cHF", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "6", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589225001728197*^9, 3.5892250086925497`*^9}, 
   3.5892993312224426`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotp1", "//", "MatrixForm"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589302361290259*^9, 3.589302364034259*^9}, 
   3.589302418624259*^9}],

Cell["Decay to 5s (F = 2)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892213643684597`*^9, 3.589221411061885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotp2", "=", 
   RowBox[{
    FractionBox[
     SubscriptBox["\[CapitalGamma]", "p"], "2"], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"d\[Rho]Lindblad", "[", 
       RowBox[{"\[Rho]Mat", ",", 
        RowBox[{"cp", "[", "q", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.58922093525784*^9, 3.5892214051658077`*^9, 
  3.589225062500331*^9, 3.589299334396443*^9, 3.589299670535443*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Decay ",
 "from",
 " the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", " ", 
    SubscriptBox["s", 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "''"}], "=", "1"}], ")"}]}], TraditionalForm]]],
 " level"
}], "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.589221162668395*^9, 3.5892211786958847`*^9}, {
  3.589221431614233*^9, 3.589221431756336*^9}, {3.589222360353148*^9, 
  3.5892223869030657`*^9}, {3.589225449294592*^9, 3.58922547113378*^9}}],

Cell["Decay to 5p (F' = 2)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892214217903223`*^9, 3.589221451388748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotc1A", "=", 
   RowBox[{
    FractionBox["5", "18"], 
    SubscriptBox["\[CapitalGamma]", "r1"], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"d\[Rho]Lindblad", "[", 
       RowBox[{"\[Rho]Mat", ",", 
        RowBox[{"cc1", "[", "q", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58917448405306*^9, 3.589174534579207*^9}, {
   3.589174769367868*^9, 3.589174791986157*^9}, {3.589174841839645*^9, 
   3.589174866925589*^9}, {3.589174904052388*^9, 3.589174920777617*^9}, {
   3.5891749542595177`*^9, 3.589174958272604*^9}, {3.589175400132916*^9, 
   3.5891754030800123`*^9}, {3.589175932663083*^9, 3.589175951973648*^9}, {
   3.589176005547415*^9, 3.589176006035077*^9}, 3.58918848943933*^9, 
   3.589188550760148*^9, {3.5892187041309643`*^9, 3.589218787945002*^9}, {
   3.589218822463533*^9, 3.589218873151518*^9}, {3.589219649948852*^9, 
   3.589219683631055*^9}, {3.58922079642677*^9, 3.589220798434442*^9}, 
   3.58922121465842*^9, 3.58922146581334*^9, 3.5892251079521503`*^9, 
   3.5892993635974426`*^9, 3.5892996743424425`*^9}],

Cell["Decay to 5s (F = 1)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892214217903223`*^9, 3.589221451388748*^9}, {
   3.589221494683339*^9, 3.589221496882846*^9}, 3.58922159619855*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotc1B", "=", 
   RowBox[{
    FractionBox["53", "108"], 
    SubscriptBox["\[CapitalGamma]", "r1"], " ", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"d\[Rho]Lindblad", "[", 
         RowBox[{"\[Rho]19", ",", 
          RowBox[{"cHF", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "11", ",", "13"}], "}"}]}], "]"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58917448405306*^9, 3.589174534579207*^9}, {
   3.589174769367868*^9, 3.589174791986157*^9}, {3.589174841839645*^9, 
   3.589174866925589*^9}, {3.589174904052388*^9, 3.589174920777617*^9}, {
   3.5891749542595177`*^9, 3.589174958272604*^9}, {3.589175400132916*^9, 
   3.5891754030800123`*^9}, {3.589175932663083*^9, 3.589175951973648*^9}, {
   3.589176005547415*^9, 3.589176006035077*^9}, 3.58918848943933*^9, 
   3.589188550760148*^9, {3.5892187041309643`*^9, 3.589218787945002*^9}, {
   3.589218822463533*^9, 3.589218873151518*^9}, {3.589219649948852*^9, 
   3.589219683631055*^9}, {3.58922079642677*^9, 3.589220798434442*^9}, 
   3.58922121465842*^9, {3.58922146581334*^9, 3.589221471057559*^9}, 
   3.589225132655079*^9, 3.589299365402443*^9}],

Cell["Decay to 5s (F = 2)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892214217903223`*^9, 3.589221451388748*^9}, {
   3.589221485531605*^9, 3.5892214899399433`*^9}, 3.5892215988154383`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotc1C", "=", 
   RowBox[{
    FractionBox[
     SubscriptBox["\[CapitalGamma]", "r1"], "5"], 
    FractionBox["25", "108"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"d\[Rho]Lindblad", "[", 
       RowBox[{"\[Rho]Mat", ",", 
        RowBox[{"lowering", "[", 
         RowBox[{"i", ",", "f"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "11", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58917448405306*^9, 3.589174534579207*^9}, {
   3.589174769367868*^9, 3.589174791986157*^9}, {3.589174841839645*^9, 
   3.589174866925589*^9}, {3.589174904052388*^9, 3.589174920777617*^9}, {
   3.5891749542595177`*^9, 3.589174958272604*^9}, {3.589175400132916*^9, 
   3.5891754030800123`*^9}, {3.589175932663083*^9, 3.589175951973648*^9}, {
   3.589176005547415*^9, 3.589176006035077*^9}, 3.58918848943933*^9, 
   3.589188550760148*^9, {3.5892187041309643`*^9, 3.589218787945002*^9}, {
   3.589218822463533*^9, 3.589218873151518*^9}, {3.589219649948852*^9, 
   3.589219683631055*^9}, {3.58922079642677*^9, 3.589220798434442*^9}, 
   3.58922121465842*^9, {3.58922146581334*^9, 3.589221471057559*^9}, 
   3.589221507750327*^9, 3.589225168834899*^9, 3.5892993716354427`*^9, 
   3.5892996761514425`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Decay ",
 "from",
 " the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", " ", 
    SubscriptBox["s", 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "''"}], "=", "2"}], ")"}]}], TraditionalForm]]],
 " level"
}], "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.589221162668395*^9, 3.5892211934761963`*^9}, {
  3.589221518482675*^9, 3.5892215186113987`*^9}, {3.589222405054695*^9, 
  3.5892224127591133`*^9}, {3.589225452262865*^9, 3.5892254726682253`*^9}}],

Cell["Decay to 5p (F' = 2)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892214217903223`*^9, 3.589221451388748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotc2A", "=", 
   RowBox[{
    FractionBox["1", "6"], 
    SubscriptBox["\[CapitalGamma]", "r2"], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"d\[Rho]Lindblad", "[", 
       RowBox[{"\[Rho]Mat", ",", 
        RowBox[{"cc2", "[", "q", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589219903282358*^9, 3.589220048088825*^9}, {
   3.5892201470187263`*^9, 3.589220159540206*^9}, 3.5892202020578938`*^9, 
   3.58922153443259*^9, 3.589225217635373*^9, 3.5892993932744427`*^9, 
   3.589299896136443*^9}],

Cell["Decay to 5s (F = 1)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892214217903223`*^9, 3.589221451388748*^9}, {
   3.589221494683339*^9, 3.589221496882846*^9}, 3.589221582479822*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotc2B", "=", 
   RowBox[{
    FractionBox["5", "36"], 
    SubscriptBox["\[CapitalGamma]", "r2"], " ", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"d\[Rho]Lindblad", "[", 
         RowBox[{"\[Rho]19", ",", 
          RowBox[{"cHF", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "14", ",", "18"}], "}"}]}], "]"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589219903282358*^9, 3.589220048088825*^9}, {
   3.5892201470187263`*^9, 3.589220159540206*^9}, 3.5892202020578938`*^9, {
   3.58922153443259*^9, 3.589221540390473*^9}, 3.589225263267201*^9, 
   3.589299394928443*^9}],

Cell["Decay to 5s (F = 2)", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5892214217903223`*^9, 3.589221451388748*^9}, {
   3.589221485531605*^9, 3.5892214899399433`*^9}, 3.589221584847187*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotc2C", "=", 
   RowBox[{
    FractionBox[
     SubscriptBox["\[CapitalGamma]", "r2"], "5"], 
    FractionBox["25", "36"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"d\[Rho]Lindblad", "[", 
       RowBox[{"\[Rho]Mat", ",", 
        RowBox[{"lowering", "[", 
         RowBox[{"i", ",", "f"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "14", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589219903282358*^9, 3.589220048088825*^9}, {
   3.5892201470187263`*^9, 3.589220159540206*^9}, 3.5892202020578938`*^9, {
   3.58922153443259*^9, 3.589221540390473*^9}, 3.589225239576186*^9, 
   3.589299398329443*^9, 3.5892999026294427`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]dotDecay", "=", 
   RowBox[{
   "\[Rho]dotp1", "+", "\[Rho]dotp2", "+", "\[Rho]dotc1A", "+", 
    "\[Rho]dotc1B", "+", "\[Rho]dotc1C", "+", "\[Rho]dotc2A", "+", 
    "\[Rho]dotc2B", "+", "\[Rho]dotc2C"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5892202113841343`*^9, 3.589220214584901*^9}, {
   3.589220373391603*^9, 3.589220382819337*^9}, {3.589220540873509*^9, 
   3.589220553559475*^9}, {3.589220975756019*^9, 3.589221011634222*^9}, 
   3.5892212384741383`*^9, {3.589222573402317*^9, 3.589222649168983*^9}, 
   3.5892999109184427`*^9, 3.5892999425734425`*^9, {3.5893021853912587`*^9, 
   3.589302190572259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]dotDecay", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalGamma]", "p"], "\[Rule]", "6"}], ",", 
       RowBox[{
        SubscriptBox["\[CapitalGamma]", "r1"], "\[Rule]", "0.05"}], ",", 
       RowBox[{
        SubscriptBox["\[CapitalGamma]", "r2"], "\[Rule]", "0.05"}], ",", " ", 
       RowBox[{"\[Gamma]p", "\[Rule]", "0.1"}], ",", 
       RowBox[{"\[Gamma]c", "\[Rule]", "1.0"}]}], "}"}]}], "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], "\[Rule]", "1"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "18"}], "}"}]}], "]"}], "]"}]}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5892202113841343`*^9, 3.589220214584901*^9}, {
   3.589220373391603*^9, 3.589220382819337*^9}, {3.589220540873509*^9, 
   3.589220553559475*^9}, {3.589220975756019*^9, 3.589221011634222*^9}, 
   3.5892212384741383`*^9, {3.589222573402317*^9, 3.589222649168983*^9}, 
   3.5892999109184427`*^9, 3.5892999425734425`*^9, {3.5893021853912587`*^9, 
   3.589302197261259*^9}, {3.589302461949259*^9, 3.589302527145259*^9}, {
   3.589302570400259*^9, 3.589302642988259*^9}, {3.589302795080259*^9, 
   3.589302802530259*^9}, {3.611028456399928*^9, 3.611028460156473*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lindblad operator; dephasing (e.g. due to laser linewidths)", \
"Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.58839960543937*^9, 3.5883996127614117`*^9}, {
  3.5884028583355093`*^9, 3.588402866343164*^9}, {3.589221683759067*^9, 
  3.589221699982891*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c\[Delta]\[Omega]p", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"{", "5", "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", "13", "}"}]}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c\[Delta]\[Omega]c", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", "10", "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"{", "8", "}"}]}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]dotDephasing", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{" ", "\[Gamma]p"}], "2"], 
     RowBox[{"d\[Rho]Lindblad", "[", 
      RowBox[{"\[Rho]Mat", ",", "c\[Delta]\[Omega]p"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["\[Gamma]c", "2"], 
     RowBox[{"d\[Rho]Lindblad", "[", 
      RowBox[{"\[Rho]Mat", ",", "c\[Delta]\[Omega]c"}], "]"}]}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883992616290617`*^9, 3.588399526095017*^9}, {
  3.588399656721279*^9, 3.588399953801655*^9}, {3.588400037364849*^9, 
  3.588400045643167*^9}, {3.5892253059356937`*^9, 3.5892253198300743`*^9}, {
  3.589225604843277*^9, 3.589225604855907*^9}, {3.589299450223443*^9, 
  3.5892994602314425`*^9}, {3.589303241086259*^9, 3.5893032446542587`*^9}, {
  3.611041880402067*^9, 3.6110418807216473`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["OBE; temporal dynamics", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.523333607859375*^9, 3.523333621328125*^9}, {
   3.52333380378125*^9, 3.5233338110625*^9}, {3.588406531557008*^9, 
   3.588406535875328*^9}, 3.5891893831786127`*^9, {3.589189529601269*^9, 
   3.589189534156423*^9}},
 FontFamily->"Verdana",
 FontSize->14],

Cell["\<\
Since we implemented a hyperfine \[OpenCurlyDoubleQuote]leak\
\[CloseCurlyDoubleQuote], Tr(\[Rho]) will decay. This ends only when all \
population is in a dark state. The dark F=1 state is outside the state space \
of \[Rho]. \
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5233338293125*^9, 3.52333391465625*^9}, {
  3.523335171921875*^9, 3.5233351888125*^9}, {3.5884065568669567`*^9, 
  3.588406595858716*^9}, {3.589189391497411*^9, 3.589189472276332*^9}, {
  3.589189544672611*^9, 3.5891895560645027`*^9}, {3.589189599877287*^9, 
  3.589189661962973*^9}},
 FontFamily->"Verdana",
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vals", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"gg", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"gp", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"gr1", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]}], ",", 
    RowBox[{"gr2", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"\[Mu]BB", "\[Rule]", 
     RowBox[{"0.72", "\[Pi]"}]}], ",", 
    RowBox[{"hfR", "\[Rule]", 
     RowBox[{"7.769", " ", "2", "\[Pi]"}]}], ",", 
    RowBox[{"\[Delta]p", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Delta]c", "\[Rule]", 
     RowBox[{"1", "\[Pi]"}]}], ",", 
    RowBox[{"\[Gamma]p", "\[Rule]", "38.1"}], ",", 
    RowBox[{"\[Gamma]c", "\[Rule]", "0.055"}], ",", 
    RowBox[{"\[CapitalOmega]p", "\[Rule]", "1."}], ",", 
    RowBox[{"\[CapitalOmega]c1", "\[Rule]", "1."}], ",", 
    RowBox[{"\[CapitalOmega]c2", "\[Rule]", "1."}], ",", 
    RowBox[{"\[Delta]\[Omega]p", "\[Rule]", "0.05"}], ",", 
    RowBox[{"\[Delta]\[Omega]c", "\[Rule]", "0.8"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588405553947711*^9, 3.588405573630307*^9}, {
   3.588405691780658*^9, 3.5884056947734823`*^9}, {3.588405738855926*^9, 
   3.5884057761037483`*^9}, 3.588406322395308*^9, {3.588406407377214*^9, 
   3.588406424752263*^9}, {3.588406723982052*^9, 3.588406745595071*^9}, 
   3.5884073059931297`*^9, 3.588411590512575*^9, {3.588411854528405*^9, 
   3.588411884944088*^9}, {3.5884125671796627`*^9, 3.5884125798214912`*^9}, {
   3.588412689332754*^9, 3.58841269233328*^9}, {3.588412729254747*^9, 
   3.588412734014153*^9}, 3.588412807280204*^9, {3.588413059233843*^9, 
   3.588413067869059*^9}, {3.589189685519784*^9, 3.5891896858247004`*^9}, {
   3.589224092041029*^9, 3.589224093409053*^9}, {3.589224130380722*^9, 
   3.589224133756689*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gg", "\[Rule]", 
    FractionBox["1", "2"]}], ",", 
   RowBox[{"gp", "\[Rule]", 
    FractionBox["2", "3"]}], ",", 
   RowBox[{"gr1", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["1", "2"]}]}], ",", 
   RowBox[{"gr2", "\[Rule]", 
    FractionBox["1", "2"]}], ",", 
   RowBox[{"\[Mu]BB", "\[Rule]", "2.261946710584651`"}], ",", 
   RowBox[{"hfR", "\[Rule]", "48.81406665147821`"}], ",", 
   RowBox[{"\[Delta]p", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Delta]c", "\[Rule]", "\[Pi]"}], ",", 
   RowBox[{"\[Gamma]p", "\[Rule]", "38.1`"}], ",", 
   RowBox[{"\[Gamma]c", "\[Rule]", "0.055`"}], ",", 
   RowBox[{"\[CapitalOmega]p", "\[Rule]", "1.`"}], ",", 
   RowBox[{"\[CapitalOmega]c1", "\[Rule]", "1.`"}], ",", 
   RowBox[{"\[CapitalOmega]c2", "\[Rule]", "1.`"}], ",", 
   RowBox[{"\[Delta]\[Omega]p", "\[Rule]", "0.05`"}], ",", 
   RowBox[{"\[Delta]\[Omega]c", "\[Rule]", "0.8`"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.588406747513795*^9, 3.5884069514869833`*^9, 3.588407161256878*^9, {
   3.588407246172195*^9, 3.588407259840952*^9}, 3.5884073081370163`*^9, 
   3.588411592253528*^9, 3.5884127356106586`*^9, 3.58841280878251*^9, 
   3.58841308217579*^9, 3.589188639209051*^9, 3.5891896706305*^9, 
   3.589223404978854*^9, 3.589224098901379*^9, 3.589224142674294*^9, 
   3.589225349505509*^9, 3.5892256153818007`*^9, 3.5893048494862585`*^9, 
   3.5893053734772587`*^9, {3.5893061826182585`*^9, 3.5893062075172586`*^9}, {
   3.5893073045356684`*^9, 3.589307328223037*^9}, 3.589307363046519*^9, 
   3.5893484689072247`*^9, 3.5893840396010323`*^9, 3.5893968510560303`*^9, 
   3.5894670933370476`*^9, 3.5894822037205677`*^9, 3.589482278520047*^9, 
   3.589513801375417*^9, 3.5895151274124174`*^9, 3.589528043125306*^9, 
   3.589528739703125*^9, 3.5897884571881113`*^9, 3.5897885640401115`*^9, 
   3.589792299446088*^9, 3.5898685291121893`*^9, 3.5964412681958237`*^9, 
   3.5964825727559247`*^9, 3.598065456871847*^9, 3.5980980032781296`*^9, 
   3.5981960742267447`*^9, 3.5981969167060466`*^9, 3.611028641123204*^9, 
   3.611029907516974*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Try to solve the equation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5805708457358804`*^9, 3.5805708509093976`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stateList", "[", "q1_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"q1", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"i", "+", "q1", "+", "5"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"i", "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "q1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"i", "-", "3", "+", "q1"}]}], "}"}]}], "]"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"q1", "\[Equal]", "0"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"i", "+", "q1", "+", "5"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"i", "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "q1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"i", "-", "3", "+", "q1"}]}], "}"}]}], "]"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"q1", "\[Equal]", "1"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"i", "+", "q1", "+", "5"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"i", "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "q1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"i", "-", "3", "+", "q1"}]}], "}"}]}], "]"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5884816981899505`*^9, {3.5893048917502584`*^9, 3.589304947313259*^9}, {
   3.5893050018452587`*^9, 3.5893050033652587`*^9}, {3.589305041171259*^9, 
   3.589305090640259*^9}, {3.5893051407012587`*^9, 3.589305167298259*^9}, {
   3.5893072093111467`*^9, 3.589307227356951*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stateList", "[", "0", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589304861905259*^9, 3.589304864466259*^9}, {
  3.589304952020259*^9, 3.5893049537882586`*^9}, {3.589305097195259*^9, 
  3.589305137176259*^9}, {3.5893070481230297`*^9, 3.589307048187036*^9}, {
  3.5964459567754908`*^9, 3.5964459639351325`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6", ",", 
     SqrtBox[
      FractionBox["2", "3"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7", ",", 
     FractionBox["1", 
      SqrtBox["6"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "9", ",", 
     FractionBox["1", 
      SqrtBox["6"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "10", ",", 
     SqrtBox[
      FractionBox["2", "3"]]}], "}"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5893051091742587`*^9, 3.5893051373972588`*^9}, 
   3.5893051710432587`*^9, 3.589307048570074*^9, 3.5893072307992954`*^9, 
   3.5893073793441486`*^9, 3.5893968595656896`*^9, 3.5894671138676834`*^9, 
   3.589482211590355*^9, 3.5894822829664917`*^9, 3.5895138074784174`*^9, 
   3.5895151426834173`*^9, 3.589528049134907*^9, 3.5895287475*^9, 
   3.5897885993371115`*^9, 3.5897923201421576`*^9, 3.5898685468579636`*^9, {
   3.5964459579954295`*^9, 3.59644596698498*^9}, 3.596482596004925*^9, 
   3.598065462585847*^9, 3.59809800597213*^9, 3.598196919566161*^9, 
   3.611028781438286*^9, 3.611029114216819*^9, 3.6110299109381123`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["numerical solutions for the susceptibility", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.588480745541211*^9, 3.588480759205577*^9}}],

Cell[CellGroupData[{

Cell["for sigma+, sigma+ transitions with n between n=19 and n=28", \
"Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5884807735420103`*^9, 3.5884807885025063`*^9}, {
  3.588480826655321*^9, 3.588480838912547*^9}, {3.5884817077789507`*^9, 
  3.5884817112749505`*^9}, {3.589384873970032*^9, 3.589384875150032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianpp", "=", 
   RowBox[{"HMatrix", "[", 
    RowBox[{"1", ",", "1", ",", "nEval"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884808478734426`*^9, 3.5884808513697925`*^9}, {
   3.5884811212277756`*^9, 3.588481121362789*^9}, {3.58848172219495*^9, 
   3.5884817279069505`*^9}, {3.589191643203125*^9, 3.5891916433125*^9}, {
   3.589307449258139*^9, 3.5893074501382275`*^9}, {3.5893076138645983`*^9, 
   3.5893076299522066`*^9}, {3.5893848767900324`*^9, 
   3.5893848831600323`*^9}, {3.589459469607255*^9, 3.589459469872455*^9}, {
   3.58979227136228*^9, 3.589792271434287*^9}, 3.5964825144789248`*^9, 
   3.598065383439847*^9, {3.5981953051435223`*^9, 3.59819530594361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sigmapp", "=", 
  RowBox[{"stateList", "[", "1", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884808609177475`*^9, 3.5884808788905444`*^9}, 
   3.5884809940230565`*^9, 3.588481151156768*^9, {3.5884817405939503`*^9, 
   3.5884817432499504`*^9}, 3.588581699488052*^9, 3.5885817363660517`*^9, 
   3.589307034258643*^9, {3.5893074315533686`*^9, 3.5893074584820614`*^9}, {
   3.589307600631275*^9, 3.58930764408062*^9}, {3.5893491585366955`*^9, 
   3.589349166605888*^9}, {3.589384879200032*^9, 3.589384890020032*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "7", ",", 
     FractionBox["1", 
      SqrtBox["3"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "9", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "10", ",", 
     FractionBox["1", 
      SqrtBox["3"]]}], "}"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.589349158836665*^9, 3.589349166965852*^9}, 
   3.5893849450000324`*^9, 3.589396859625687*^9, 3.5894671139456835`*^9, 
   3.589482211651361*^9, 3.5894822830334983`*^9, 3.5895138075494175`*^9, 
   3.589515142751417*^9, 3.58952804916391*^9, 3.589528747578125*^9, 
   3.589788599385111*^9, 3.5897923202131643`*^9, 3.5898685469289703`*^9, 
   3.5964476361877193`*^9, 3.596482596120925*^9, 3.598065462628847*^9, 
   3.5980980060191298`*^9, 3.598196919646164*^9, 3.611028781577244*^9, 
   3.6110291143825417`*^9, 3.611029911022388*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Rho]pp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"commutator", "[", 
      RowBox[{"Hamiltonianpp", ",", "\[Rho]Mat"}], "]"}]}], "+", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"\[Rho]dotDecay", "+", "\[Rho]dotDephasing"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "p"], "\[Rule]", "6"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r1"], "\[Rule]", "0.05"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r2"], "\[Rule]", "0.05"}], ",", " ", 
        RowBox[{"\[Gamma]p", "\[Rule]", "0.1"}], ",", 
        RowBox[{"\[Gamma]c", "\[Rule]", "1."}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5612896318905067`*^9, 3.561289632842441*^9}, {
   3.561373895598744*^9, 3.561373896294491*^9}, {3.5620673943546352`*^9, 
   3.5620673948179502`*^9}, {3.580052029892891*^9, 3.5800520317394247`*^9}, {
   3.580053538329997*^9, 3.580053543872665*^9}, {3.580091612136181*^9, 
   3.580091614374968*^9}, {3.580443433413706*^9, 3.5804434382448163`*^9}, 
   3.580572447151594*^9, 3.583334118971817*^9, {3.583390220568582*^9, 
   3.583390255406143*^9}, 3.5834131644304605`*^9, {3.5834372661598463`*^9, 
   3.583437281249355*^9}, {3.5877213636772523`*^9, 3.5877214155372524`*^9}, 
   3.587726684823252*^9, {3.587733588268838*^9, 3.5877335995714846`*^9}, 
   3.587787215509454*^9, {3.5879829419277477`*^9, 3.587982944558748*^9}, {
   3.5880604220217175`*^9, 3.588060436822198*^9}, {3.588060477623277*^9, 
   3.5880604852080355`*^9}, {3.5883200329414377`*^9, 3.588320051730686*^9}, {
   3.5883200870192747`*^9, 3.588320089989156*^9}, 3.588320679447544*^9, 
   3.588397663988197*^9, {3.58839781282522*^9, 3.588397852064435*^9}, 
   3.5884025377441545`*^9, 3.5884070966896963`*^9, {3.5884071316586475`*^9, 
   3.588407133448593*^9}, {3.5885717137139163`*^9, 3.5885717171059165`*^9}, 
   3.588581569114052*^9, {3.589191573953125*^9, 3.589191576015625*^9}, 
   3.5893016237152586`*^9, {3.589301758731259*^9, 3.589301771889259*^9}, {
   3.5893020571682587`*^9, 3.589302086982259*^9}, 3.589302658530259*^9, {
   3.589303365044259*^9, 3.589303368188259*^9}, {3.5893034656472588`*^9, 
   3.5893034675262585`*^9}, 3.5893035415852585`*^9, {3.5893037047432585`*^9, 
   3.589303711902259*^9}, {3.589384892650032*^9, 3.5893848957500324`*^9}, {
   3.611028662905698*^9, 3.611028666671872*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obepp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"\[Rho]Mat", ",", "t"}], "]"}], ",", "d\[Rho]pp"}], "}"}], 
        ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"\[Delta]p", "\[Rule]", "#3"}], ",", " ", 
       RowBox[{"\[Delta]c", "\[Rule]", "#1"}], ",", 
       RowBox[{"BField", "\[Rule]", "#2"}]}], "}"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{"Equal", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]Mat", "/.", 
         RowBox[{"t", "\[Rule]", "0"}]}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0.2", ",", 
             RowBox[{"{", "5", "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "13", "}"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
      "2"}], "]"}], "//", "Flatten"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588410695553664*^9, 3.5884107312544193`*^9}, 
   3.588410808960699*^9, {3.588410862982215*^9, 3.5884108732313347`*^9}, 
   3.58841099113244*^9, {3.588411264175599*^9, 3.588411300060585*^9}, {
   3.588411369222816*^9, 3.588411412749528*^9}, 3.588411455203801*^9, {
   3.589189495903295*^9, 3.589189502384214*^9}, {3.589222663121714*^9, 
   3.589222673705222*^9}, {3.5892234676989737`*^9, 3.589223480027801*^9}, 
   3.589223612862843*^9, 3.589223821727404*^9, 3.58922560480809*^9, {
   3.589300076969259*^9, 3.589300094152259*^9}, {3.5893014031802588`*^9, 
   3.5893014187462587`*^9}, {3.5893014546442585`*^9, 3.589301504893259*^9}, {
   3.5893016108072586`*^9, 3.5893016165822587`*^9}, {3.5893017133382587`*^9, 
   3.5893017494062586`*^9}, {3.589301806785259*^9, 3.589301865535259*^9}, {
   3.589303015948259*^9, 3.5893030164672585`*^9}, 3.589303146091259*^9, {
   3.589303184985259*^9, 3.589303204535259*^9}, {3.589303738278259*^9, 
   3.589303749916259*^9}, {3.589384900470032*^9, 3.589384903700032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptpp", "[", 
   RowBox[{
    RowBox[{"\[CapitalDelta]_", "?", "NumericQ"}], ",", 
    RowBox[{"Field_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Delta]I_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sigmapp", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Im", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{
            RowBox[{"sigmapp", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"sigmapp", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], "[",
           "3", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sigmapp", "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"obepp", "[", 
           RowBox[{"\[CapitalDelta]", ",", "Field", ",", "\[Delta]I"}], "]"}],
           ",", "ic"}], "]"}], "]"}], ",", 
       RowBox[{"Flatten", "[", "\[Rho]Mat2", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3.5"}], "}"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}]}], ",", "2"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884809990725613`*^9, 3.5884811010827613`*^9}, {
   3.588481156485301*^9, 3.588481159205573*^9}, {3.5884813026829195`*^9, 
   3.588481303122963*^9}, {3.5884817527379503`*^9, 3.5884817727289505`*^9}, {
   3.5884826039959507`*^9, 3.58848260429895*^9}, {3.5884829092079506`*^9, 
   3.5884829093119507`*^9}, {3.5884856917393064`*^9, 
   3.5884857344093065`*^9}, {3.588486479401307*^9, 3.5884864994873066`*^9}, {
   3.588500079848832*^9, 3.588500105099832*^9}, {3.5885027812570753`*^9, 
   3.5885027813690863`*^9}, {3.5885028144103904`*^9, 
   3.5885028256595154`*^9}, {3.5885107166684084`*^9, 
   3.5885107177234087`*^9}, {3.5885108261094084`*^9, 
   3.5885108262844086`*^9}, {3.588584670019052*^9, 3.588584673099052*^9}, {
   3.5885851535802107`*^9, 3.5885851543962927`*^9}, 3.5885851994537973`*^9, 
   3.5886037917887735`*^9, 3.588603824192774*^9, {3.588911785807418*^9, 
   3.5889117973525724`*^9}, {3.589177939328125*^9, 3.589177941640625*^9}, {
   3.589303826849259*^9, 3.589303843520259*^9}, {3.589305189353259*^9, 
   3.589305203032259*^9}, {3.589305848495259*^9, 3.589305891804259*^9}, {
   3.589306070848259*^9, 3.5893060724962587`*^9}, {3.589306271787259*^9, 
   3.589306283395259*^9}, 3.589307404092623*^9, {3.5893487662225423`*^9, 
   3.589348775651411*^9}, 3.5893488169364557`*^9, 3.5893488912575364`*^9, {
   3.589348945191064*^9, 3.589349005223859*^9}, {3.5893490392097797`*^9, 
   3.5893490515792956`*^9}, {3.589349136359121*^9, 3.5893491462579327`*^9}, {
   3.5893491983227158`*^9, 3.589349198952653*^9}, {3.5893492340061474`*^9, 
   3.5893492441651316`*^9}, {3.5893493070488424`*^9, 
   3.5893493072988176`*^9}, {3.5893499111594253`*^9, 3.589349915039037*^9}, {
   3.5893502069232826`*^9, 3.5893502076132274`*^9}, {3.5893508633127675`*^9, 
   3.589350871812087*^9}, {3.589384917100032*^9, 3.5893849307100325`*^9}, {
   3.589788637783111*^9, 3.5897886402851114`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptpp", "[", 
   RowBox[{"0", ",", "0", ",", "0"}], "]"}], "//", "Timing"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884811622178745`*^9, 3.5884811844560976`*^9}, 
   3.58848123798345*^9, {3.5884813742600765`*^9, 3.588481375879238*^9}, 
   3.5884814332789774`*^9, {3.5884817751839504`*^9, 3.5884817757669506`*^9}, {
   3.5884826116019506`*^9, 3.5884826120339503`*^9}, 3.5884829890979505`*^9, {
   3.5884832115789504`*^9, 3.58848321566695*^9}, {3.588485279692381*^9, 
   3.5884852822366357`*^9}, {3.588485319318343*^9, 3.588485320253437*^9}, {
   3.588485374047816*^9, 3.5884853750159125`*^9}, {3.588485621753584*^9, 
   3.5884856409135*^9}, {3.588485716552307*^9, 3.5884857179923067`*^9}, {
   3.588485764309307*^9, 3.588485785804307*^9}, {3.588485838481307*^9, 
   3.5884859089403067`*^9}, {3.588486315707307*^9, 3.588486322602307*^9}, {
   3.5884863839663067`*^9, 3.5884864396663065`*^9}, {3.588486537924307*^9, 
   3.588486559109307*^9}, {3.5893052078682585`*^9, 3.5893052082602587`*^9}, 
   3.589305862698259*^9, {3.5893070156267805`*^9, 3.589307015794797*^9}, 
   3.589307245314747*^9, 3.589307420625276*^9, 3.589307596998912*^9, 
   3.589350876551708*^9, {3.589384933220032*^9, 3.589384934220032*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.12027799999999999602806610710103996098`5.100786111256614", ",", 
   RowBox[{"-", "0.046314377274063526`"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5884811729309454`*^9, 3.5884811862102733`*^9}, 
   3.5884812392565775`*^9, {3.5884813506067114`*^9, 3.588481377239374*^9}, 
   3.5884814343170815`*^9, 3.58848178693095*^9, 3.58848181706295*^9, 
   3.58848261496395*^9, {3.5884828905209503`*^9, 3.58848291533895*^9}, 
   3.5884829911599503`*^9, {3.5884832067199507`*^9, 3.5884832167739506`*^9}, 
   3.5884833976229506`*^9, 3.588484074067917*^9, 3.5884841487339168`*^9, 
   3.588484214232917*^9, 3.5884851706634793`*^9, 3.588485290162428*^9, 
   3.5884853241918306`*^9, 3.5884853798673973`*^9, {3.5884856301614246`*^9, 
   3.588485646226031*^9}, {3.5884856974023066`*^9, 3.588485786996307*^9}, {
   3.5884858391593065`*^9, 3.588485866628307*^9}, {3.588485896700307*^9, 
   3.588485910147307*^9}, {3.588486318615307*^9, 3.5884863233413067`*^9}, {
   3.5884864109753065`*^9, 3.588486448510307*^9}, 3.588486517943307*^9, {
   3.588486555193307*^9, 3.588486560129307*^9}, {3.588500097929832*^9, 
   3.5885001079908323`*^9}, 3.588502791373087*^9, {3.5885028223091803`*^9, 
   3.58850282931088*^9}, {3.5885108225894084`*^9, 3.5885108304424086`*^9}, 
   3.588522599895542*^9, 3.5885278674816465`*^9, 3.5885734948253064`*^9, 
   3.5885749002443066`*^9, 3.5885769873331413`*^9, 3.588580170311493*^9, 
   3.588581594707052*^9, 3.5885838257740517`*^9, 3.588584887739052*^9, 
   3.5885851664775004`*^9, 3.58858520967782*^9, 3.5886042047647734`*^9, 
   3.5886528466634254`*^9, 3.58892810540625*^9, 3.588928374*^9, 
   3.58892858003125*^9, 3.589089374328125*^9, 3.589120459*^9, 
   3.589191651046875*^9, {3.589303857584259*^9, 3.589303871801259*^9}, {
   3.589305180060259*^9, 3.5893052129112587`*^9}, {3.589305382181259*^9, 
   3.5893053917132587`*^9}, 3.589305897955259*^9, 3.589306077067259*^9, 
   3.589306810006259*^9, {3.5893070165768757`*^9, 3.5893070394091587`*^9}, 
   3.5893070759318104`*^9, 3.5893072164858646`*^9, 3.589307247380954*^9, {
   3.589307393518566*^9, 3.5893074811143246`*^9}, {3.5893075978379955`*^9, 
   3.5893076460248137`*^9}, 3.5893486580055304`*^9, 3.589348695351048*^9, 
   3.5893488960969553`*^9, {3.5893489499904876`*^9, 3.5893490078535433`*^9}, {
   3.589349141748474*^9, 3.589349172305318*^9}, {3.5893492401755304`*^9, 
   3.5893492468648615`*^9}, 3.5893493117383738`*^9, 3.589350877191657*^9, 
   3.5893849451700325`*^9, 3.5893968597656813`*^9, 3.589467114132884*^9, 
   3.5894822118063765`*^9, 3.5894822831715126`*^9, 3.589513807686417*^9, 
   3.589515142908417*^9, 3.5895280493079243`*^9, 3.58952874784375*^9, 
   3.589788599612111*^9, 3.5897923203621793`*^9, 3.5898685470959873`*^9, 
   3.5964476363577137`*^9, 3.596482596306925*^9, 3.5980654627778473`*^9, 
   3.5980980061671295`*^9, 3.5981969198061705`*^9, 3.611028782042803*^9, 
   3.611029114605921*^9, 3.611029911279223*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["for sigma-, sigma- transitions with n between n=19 and n=28", \
"Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5884807735420103`*^9, 3.5884807885025063`*^9}, {
  3.588480826655321*^9, 3.588480838912547*^9}, {3.5884817077789507`*^9, 
  3.5884817112749505`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianmm", "=", 
   RowBox[{"HMatrix", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "nEval"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884808478734426`*^9, 3.5884808513697925`*^9}, {
   3.5884811212277756`*^9, 3.588481121362789*^9}, {3.58848172219495*^9, 
   3.5884817279069505`*^9}, {3.589191643203125*^9, 3.5891916433125*^9}, {
   3.589307449258139*^9, 3.5893074501382275`*^9}, {3.5893076138645983`*^9, 
   3.5893076299522066`*^9}, {3.5894594753324647`*^9, 
   3.5894594756444654`*^9}, {3.5897922743215756`*^9, 3.589792274409584*^9}, 
   3.596482512214925*^9, 3.598065386493847*^9, {3.598195311884264*^9, 
   3.5981953125143332`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianmm", "//", "MatrixForm"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589307102564473*^9, 3.58930712593381*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sigmamm", "=", 
  RowBox[{"stateList", "[", 
   RowBox[{"-", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884808609177475`*^9, 3.5884808788905444`*^9}, 
   3.5884809940230565`*^9, 3.588481151156768*^9, {3.5884817405939503`*^9, 
   3.5884817432499504`*^9}, 3.588581699488052*^9, 3.5885817363660517`*^9, 
   3.589307034258643*^9, {3.5893074315533686`*^9, 3.5893074584820614`*^9}, {
   3.589307600631275*^9, 3.58930764408062*^9}, {3.5893491585366955`*^9, 
   3.589349166605888*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "6", ",", 
     FractionBox["1", 
      SqrtBox["3"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "8", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9", ",", 
     FractionBox["1", 
      SqrtBox["3"]]}], "}"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.589349158836665*^9, 3.589349166965852*^9}, 
   3.5893968598156796`*^9, 3.589467114195284*^9, 3.589482211853381*^9, 
   3.589482283221517*^9, 3.5895138077364173`*^9, 3.589515142972417*^9, 
   3.589528049335927*^9, 3.58952874790625*^9, 3.589788599683111*^9, 
   3.589792320422185*^9, 3.589868547150993*^9, 3.5964476363977127`*^9, 
   3.596482596387925*^9, 3.5980654628048472`*^9, 3.5980980062021294`*^9, 
   3.598196919836172*^9, 3.611028782138988*^9, 3.611029114700815*^9, 
   3.611029911357421*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Rho]mm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"commutator", "[", 
      RowBox[{"Hamiltonianmm", ",", "\[Rho]Mat"}], "]"}]}], "+", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"\[Rho]dotDecay", "+", "\[Rho]dotDephasing"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "p"], "\[Rule]", "6"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r1"], "\[Rule]", "0.05"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r2"], "\[Rule]", "0.05"}], ",", " ", 
        RowBox[{"\[Gamma]p", "\[Rule]", "0.1"}], ",", 
        RowBox[{"\[Gamma]c", "\[Rule]", "1."}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5612896318905067`*^9, 3.561289632842441*^9}, {
   3.561373895598744*^9, 3.561373896294491*^9}, {3.5620673943546352`*^9, 
   3.5620673948179502`*^9}, {3.580052029892891*^9, 3.5800520317394247`*^9}, {
   3.580053538329997*^9, 3.580053543872665*^9}, {3.580091612136181*^9, 
   3.580091614374968*^9}, {3.580443433413706*^9, 3.5804434382448163`*^9}, 
   3.580572447151594*^9, 3.583334118971817*^9, {3.583390220568582*^9, 
   3.583390255406143*^9}, 3.5834131644304605`*^9, {3.5834372661598463`*^9, 
   3.583437281249355*^9}, {3.5877213636772523`*^9, 3.5877214155372524`*^9}, 
   3.587726684823252*^9, {3.587733588268838*^9, 3.5877335995714846`*^9}, 
   3.587787215509454*^9, {3.5879829419277477`*^9, 3.587982944558748*^9}, {
   3.5880604220217175`*^9, 3.588060436822198*^9}, {3.588060477623277*^9, 
   3.5880604852080355`*^9}, {3.5883200329414377`*^9, 3.588320051730686*^9}, {
   3.5883200870192747`*^9, 3.588320089989156*^9}, 3.588320679447544*^9, 
   3.588397663988197*^9, {3.58839781282522*^9, 3.588397852064435*^9}, 
   3.5884025377441545`*^9, 3.5884070966896963`*^9, {3.5884071316586475`*^9, 
   3.588407133448593*^9}, {3.5885717137139163`*^9, 3.5885717171059165`*^9}, 
   3.588581569114052*^9, {3.589191573953125*^9, 3.589191576015625*^9}, 
   3.5893016237152586`*^9, {3.589301758731259*^9, 3.589301771889259*^9}, {
   3.5893020571682587`*^9, 3.589302086982259*^9}, 3.589302658530259*^9, {
   3.589303365044259*^9, 3.589303368188259*^9}, {3.5893034656472588`*^9, 
   3.5893034675262585`*^9}, 3.5893035415852585`*^9, {3.5893037047432585`*^9, 
   3.589303711902259*^9}, {3.611028702600182*^9, 3.611028706130221*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obemm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"\[Rho]Mat", ",", "t"}], "]"}], ",", "d\[Rho]mm"}], "}"}], 
        ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"\[Delta]p", "\[Rule]", "#3"}], ",", " ", 
       RowBox[{"\[Delta]c", "\[Rule]", "#1"}], ",", 
       RowBox[{"BField", "\[Rule]", "#2"}]}], "}"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{"Equal", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]Mat", "/.", 
         RowBox[{"t", "\[Rule]", "0"}]}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0.2", ",", 
             RowBox[{"{", "5", "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "13", "}"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
      "2"}], "]"}], "//", "Flatten"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588410695553664*^9, 3.5884107312544193`*^9}, 
   3.588410808960699*^9, {3.588410862982215*^9, 3.5884108732313347`*^9}, 
   3.58841099113244*^9, {3.588411264175599*^9, 3.588411300060585*^9}, {
   3.588411369222816*^9, 3.588411412749528*^9}, 3.588411455203801*^9, {
   3.589189495903295*^9, 3.589189502384214*^9}, {3.589222663121714*^9, 
   3.589222673705222*^9}, {3.5892234676989737`*^9, 3.589223480027801*^9}, 
   3.589223612862843*^9, 3.589223821727404*^9, 3.58922560480809*^9, {
   3.589300076969259*^9, 3.589300094152259*^9}, {3.5893014031802588`*^9, 
   3.5893014187462587`*^9}, {3.5893014546442585`*^9, 3.589301504893259*^9}, {
   3.5893016108072586`*^9, 3.5893016165822587`*^9}, {3.5893017133382587`*^9, 
   3.5893017494062586`*^9}, {3.589301806785259*^9, 3.589301865535259*^9}, {
   3.589303015948259*^9, 3.5893030164672585`*^9}, 3.589303146091259*^9, {
   3.589303184985259*^9, 3.589303204535259*^9}, {3.589303738278259*^9, 
   3.589303749916259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptmm", "[", 
   RowBox[{
    RowBox[{"\[CapitalDelta]_", "?", "NumericQ"}], ",", 
    RowBox[{"Field_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Delta]I_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sigmamm", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Im", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{
            RowBox[{"sigmamm", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"sigmamm", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], "[",
           "3", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sigmamm", "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"obemm", "[", 
           RowBox[{"\[CapitalDelta]", ",", "Field", ",", "\[Delta]I"}], "]"}],
           ",", "ic"}], "]"}], "]"}], ",", 
       RowBox[{"Flatten", "[", "\[Rho]Mat2", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3.5"}], "}"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}]}], ",", "2"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884809990725613`*^9, 3.5884811010827613`*^9}, {
   3.588481156485301*^9, 3.588481159205573*^9}, {3.5884813026829195`*^9, 
   3.588481303122963*^9}, {3.5884817527379503`*^9, 3.5884817727289505`*^9}, {
   3.5884826039959507`*^9, 3.58848260429895*^9}, {3.5884829092079506`*^9, 
   3.5884829093119507`*^9}, {3.5884856917393064`*^9, 
   3.5884857344093065`*^9}, {3.588486479401307*^9, 3.5884864994873066`*^9}, {
   3.588500079848832*^9, 3.588500105099832*^9}, {3.5885027812570753`*^9, 
   3.5885027813690863`*^9}, {3.5885028144103904`*^9, 
   3.5885028256595154`*^9}, {3.5885107166684084`*^9, 
   3.5885107177234087`*^9}, {3.5885108261094084`*^9, 
   3.5885108262844086`*^9}, {3.588584670019052*^9, 3.588584673099052*^9}, {
   3.5885851535802107`*^9, 3.5885851543962927`*^9}, 3.5885851994537973`*^9, 
   3.5886037917887735`*^9, 3.588603824192774*^9, {3.588911785807418*^9, 
   3.5889117973525724`*^9}, {3.589177939328125*^9, 3.589177941640625*^9}, {
   3.589303826849259*^9, 3.589303843520259*^9}, {3.589305189353259*^9, 
   3.589305203032259*^9}, {3.589305848495259*^9, 3.589305891804259*^9}, {
   3.589306070848259*^9, 3.5893060724962587`*^9}, {3.589306271787259*^9, 
   3.589306283395259*^9}, 3.589307404092623*^9, {3.5893487662225423`*^9, 
   3.589348775651411*^9}, 3.5893488169364557`*^9, 3.5893488912575364`*^9, {
   3.589348945191064*^9, 3.589349005223859*^9}, {3.5893490392097797`*^9, 
   3.5893490515792956`*^9}, {3.589349136359121*^9, 3.5893491462579327`*^9}, {
   3.5893491983227158`*^9, 3.589349198952653*^9}, {3.5893492340061474`*^9, 
   3.5893492441651316`*^9}, {3.5893493070488424`*^9, 
   3.5893493072988176`*^9}, {3.5893499111594253`*^9, 3.589349915039037*^9}, {
   3.5893502069232826`*^9, 3.5893502076132274`*^9}, {3.5893508633127675`*^9, 
   3.589350871812087*^9}, {3.5895281256325555`*^9, 3.589528128319824*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptmm", "[", 
   RowBox[{"0", ",", "0", ",", "0"}], "]"}], "//", "Timing"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884811622178745`*^9, 3.5884811844560976`*^9}, 
   3.58848123798345*^9, {3.5884813742600765`*^9, 3.588481375879238*^9}, 
   3.5884814332789774`*^9, {3.5884817751839504`*^9, 3.5884817757669506`*^9}, {
   3.5884826116019506`*^9, 3.5884826120339503`*^9}, 3.5884829890979505`*^9, {
   3.5884832115789504`*^9, 3.58848321566695*^9}, {3.588485279692381*^9, 
   3.5884852822366357`*^9}, {3.588485319318343*^9, 3.588485320253437*^9}, {
   3.588485374047816*^9, 3.5884853750159125`*^9}, {3.588485621753584*^9, 
   3.5884856409135*^9}, {3.588485716552307*^9, 3.5884857179923067`*^9}, {
   3.588485764309307*^9, 3.588485785804307*^9}, {3.588485838481307*^9, 
   3.5884859089403067`*^9}, {3.588486315707307*^9, 3.588486322602307*^9}, {
   3.5884863839663067`*^9, 3.5884864396663065`*^9}, {3.588486537924307*^9, 
   3.588486559109307*^9}, {3.5893052078682585`*^9, 3.5893052082602587`*^9}, 
   3.589305862698259*^9, {3.5893070156267805`*^9, 3.589307015794797*^9}, 
   3.589307245314747*^9, 3.589307420625276*^9, 3.589307596998912*^9, 
   3.589350876551708*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.12924499999999999877431378081382717937`5.1320136641604055", ",", 
   "0.04631437727406353`"}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5884811729309454`*^9, 3.5884811862102733`*^9}, 
   3.5884812392565775`*^9, {3.5884813506067114`*^9, 3.588481377239374*^9}, 
   3.5884814343170815`*^9, 3.58848178693095*^9, 3.58848181706295*^9, 
   3.58848261496395*^9, {3.5884828905209503`*^9, 3.58848291533895*^9}, 
   3.5884829911599503`*^9, {3.5884832067199507`*^9, 3.5884832167739506`*^9}, 
   3.5884833976229506`*^9, 3.588484074067917*^9, 3.5884841487339168`*^9, 
   3.588484214232917*^9, 3.5884851706634793`*^9, 3.588485290162428*^9, 
   3.5884853241918306`*^9, 3.5884853798673973`*^9, {3.5884856301614246`*^9, 
   3.588485646226031*^9}, {3.5884856974023066`*^9, 3.588485786996307*^9}, {
   3.5884858391593065`*^9, 3.588485866628307*^9}, {3.588485896700307*^9, 
   3.588485910147307*^9}, {3.588486318615307*^9, 3.5884863233413067`*^9}, {
   3.5884864109753065`*^9, 3.588486448510307*^9}, 3.588486517943307*^9, {
   3.588486555193307*^9, 3.588486560129307*^9}, {3.588500097929832*^9, 
   3.5885001079908323`*^9}, 3.588502791373087*^9, {3.5885028223091803`*^9, 
   3.58850282931088*^9}, {3.5885108225894084`*^9, 3.5885108304424086`*^9}, 
   3.588522599895542*^9, 3.5885278674816465`*^9, 3.5885734948253064`*^9, 
   3.5885749002443066`*^9, 3.5885769873331413`*^9, 3.588580170311493*^9, 
   3.588581594707052*^9, 3.5885838257740517`*^9, 3.588584887739052*^9, 
   3.5885851664775004`*^9, 3.58858520967782*^9, 3.5886042047647734`*^9, 
   3.5886528466634254`*^9, 3.58892810540625*^9, 3.588928374*^9, 
   3.58892858003125*^9, 3.589089374328125*^9, 3.589120459*^9, 
   3.589191651046875*^9, {3.589303857584259*^9, 3.589303871801259*^9}, {
   3.589305180060259*^9, 3.5893052129112587`*^9}, {3.589305382181259*^9, 
   3.5893053917132587`*^9}, 3.589305897955259*^9, 3.589306077067259*^9, 
   3.589306810006259*^9, {3.5893070165768757`*^9, 3.5893070394091587`*^9}, 
   3.5893070759318104`*^9, 3.5893072164858646`*^9, 3.589307247380954*^9, {
   3.589307393518566*^9, 3.5893074811143246`*^9}, {3.5893075978379955`*^9, 
   3.5893076460248137`*^9}, 3.5893486580055304`*^9, 3.589348695351048*^9, 
   3.5893488960969553`*^9, {3.5893489499904876`*^9, 3.5893490078535433`*^9}, {
   3.589349141748474*^9, 3.589349172305318*^9}, {3.5893492401755304`*^9, 
   3.5893492468648615`*^9}, 3.5893493117383738`*^9, 3.589350877191657*^9, 
   3.5893968599456744`*^9, 3.5894671143824844`*^9, 3.5894822119873943`*^9, 
   3.58948228334953*^9, 3.589513807864417*^9, 3.589515143104417*^9, 
   3.5895280494869423`*^9, 3.589528748140625*^9, 3.589788599923111*^9, 
   3.5897923205551987`*^9, 3.5898685472870064`*^9, 3.5964476365477085`*^9, 
   3.5964825965539246`*^9, 3.598065462949847*^9, 3.5980980063431296`*^9, 
   3.5981969199861774`*^9, 3.611028782550228*^9, 3.611029114919807*^9, 
   3.6110299116253757`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["for sigma+, sigma- transitions with n between n=19 and n=28", \
"Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5884807735420103`*^9, 3.5884807885025063`*^9}, {
  3.588480826655321*^9, 3.588480838912547*^9}, {3.5884817077789507`*^9, 
  3.5884817112749505`*^9}, {3.5893840736510324`*^9, 3.5893840741710324`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianpm", "=", 
   RowBox[{"HMatrix", "[", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "nEval"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884808478734426`*^9, 3.5884808513697925`*^9}, {
   3.5884811212277756`*^9, 3.588481121362789*^9}, {3.58848172219495*^9, 
   3.5884817279069505`*^9}, {3.589191643203125*^9, 3.5891916433125*^9}, {
   3.589307449258139*^9, 3.5893074501382275`*^9}, {3.5893076138645983`*^9, 
   3.5893076299522066`*^9}, {3.589384085922013*^9, 3.5893841044420323`*^9}, {
   3.589459481057675*^9, 3.5894594814008756`*^9}, {3.589792276401784*^9, 
   3.58979227646579*^9}, 3.596482517740925*^9, 3.598065394920847*^9, {
   3.598195316375758*^9, 3.598195317065834*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianpm", "//", "MatrixForm"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589307102564473*^9, 3.58930712593381*^9}, 
   3.589384101122032*^9, 3.5893841698120327`*^9, {3.589384380782032*^9, 
   3.589384381282032*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sigmapm", "=", 
  RowBox[{"stateList", "[", "1", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884808609177475`*^9, 3.5884808788905444`*^9}, 
   3.5884809940230565`*^9, 3.588481151156768*^9, {3.5884817405939503`*^9, 
   3.5884817432499504`*^9}, 3.588581699488052*^9, 3.5885817363660517`*^9, 
   3.589307034258643*^9, {3.5893074315533686`*^9, 3.5893074584820614`*^9}, {
   3.589307600631275*^9, 3.58930764408062*^9}, {3.5893491585366955`*^9, 
   3.589349166605888*^9}, {3.589384081062006*^9, 3.589384096622028*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "7", ",", 
     FractionBox["1", 
      SqrtBox["3"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "9", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "10", ",", 
     FractionBox["1", 
      SqrtBox["3"]]}], "}"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.589349158836665*^9, 3.589349166965852*^9}, {
   3.5893841576720324`*^9, 3.5893841734620323`*^9}, 3.589396859995672*^9, 
   3.5894671144604845`*^9, 3.5894822120404*^9, 3.589482283399535*^9, 
   3.589513807918417*^9, 3.5895151431644173`*^9, {3.5895280343674297`*^9, 
   3.589528049516945*^9}, 3.589528748203125*^9, 3.589788599970111*^9, 
   3.5897923206162043`*^9, 3.5898685473660145`*^9, 3.5964476365877075`*^9, 
   3.5964825966369247`*^9, 3.5980654629748473`*^9, 3.5980980063811293`*^9, 
   3.5981969200261793`*^9, 3.6110287827393227`*^9, 3.611029115018808*^9, 
   3.611029911772559*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Rho]pm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"commutator", "[", 
      RowBox[{"Hamiltonianpm", ",", "\[Rho]Mat"}], "]"}]}], "+", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"\[Rho]dotDecay", "+", "\[Rho]dotDephasing"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "p"], "\[Rule]", "6"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r1"], "\[Rule]", "0.05"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r2"], "\[Rule]", "0.05"}], ",", " ", 
        RowBox[{"\[Gamma]p", "\[Rule]", "0.1"}], ",", 
        RowBox[{"\[Gamma]c", "\[Rule]", "1."}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5612896318905067`*^9, 3.561289632842441*^9}, {
   3.561373895598744*^9, 3.561373896294491*^9}, {3.5620673943546352`*^9, 
   3.5620673948179502`*^9}, {3.580052029892891*^9, 3.5800520317394247`*^9}, {
   3.580053538329997*^9, 3.580053543872665*^9}, {3.580091612136181*^9, 
   3.580091614374968*^9}, {3.580443433413706*^9, 3.5804434382448163`*^9}, 
   3.580572447151594*^9, 3.583334118971817*^9, {3.583390220568582*^9, 
   3.583390255406143*^9}, 3.5834131644304605`*^9, {3.5834372661598463`*^9, 
   3.583437281249355*^9}, {3.5877213636772523`*^9, 3.5877214155372524`*^9}, 
   3.587726684823252*^9, {3.587733588268838*^9, 3.5877335995714846`*^9}, 
   3.587787215509454*^9, {3.5879829419277477`*^9, 3.587982944558748*^9}, {
   3.5880604220217175`*^9, 3.588060436822198*^9}, {3.588060477623277*^9, 
   3.5880604852080355`*^9}, {3.5883200329414377`*^9, 3.588320051730686*^9}, {
   3.5883200870192747`*^9, 3.588320089989156*^9}, 3.588320679447544*^9, 
   3.588397663988197*^9, {3.58839781282522*^9, 3.588397852064435*^9}, 
   3.5884025377441545`*^9, 3.5884070966896963`*^9, {3.5884071316586475`*^9, 
   3.588407133448593*^9}, {3.5885717137139163`*^9, 3.5885717171059165`*^9}, 
   3.588581569114052*^9, {3.589191573953125*^9, 3.589191576015625*^9}, 
   3.5893016237152586`*^9, {3.589301758731259*^9, 3.589301771889259*^9}, {
   3.5893020571682587`*^9, 3.589302086982259*^9}, 3.589302658530259*^9, {
   3.589303365044259*^9, 3.589303368188259*^9}, {3.5893034656472588`*^9, 
   3.5893034675262585`*^9}, 3.5893035415852585`*^9, {3.5893037047432585`*^9, 
   3.589303711902259*^9}, {3.589384093822024*^9, 3.5893841088220325`*^9}, {
   3.611044468287607*^9, 3.611044471054336*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obepm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"\[Rho]Mat", ",", "t"}], "]"}], ",", "d\[Rho]pm"}], "}"}], 
        ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"\[Delta]c", "\[Rule]", "#1"}], ",", 
       RowBox[{"BField", "\[Rule]", "#2"}], ",", " ", 
       RowBox[{"\[Delta]p", "\[Rule]", "#3"}]}], "}"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{"Equal", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]Mat", "/.", 
         RowBox[{"t", "\[Rule]", "0"}]}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0.2", ",", 
             RowBox[{"{", "5", "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "13", "}"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
      "2"}], "]"}], "//", "Flatten"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588410695553664*^9, 3.5884107312544193`*^9}, 
   3.588410808960699*^9, {3.588410862982215*^9, 3.5884108732313347`*^9}, 
   3.58841099113244*^9, {3.588411264175599*^9, 3.588411300060585*^9}, {
   3.588411369222816*^9, 3.588411412749528*^9}, 3.588411455203801*^9, {
   3.589189495903295*^9, 3.589189502384214*^9}, {3.589222663121714*^9, 
   3.589222673705222*^9}, {3.5892234676989737`*^9, 3.589223480027801*^9}, 
   3.589223612862843*^9, 3.589223821727404*^9, 3.58922560480809*^9, {
   3.589300076969259*^9, 3.589300094152259*^9}, {3.5893014031802588`*^9, 
   3.5893014187462587`*^9}, {3.5893014546442585`*^9, 3.589301504893259*^9}, {
   3.5893016108072586`*^9, 3.5893016165822587`*^9}, {3.5893017133382587`*^9, 
   3.5893017494062586`*^9}, {3.589301806785259*^9, 3.589301865535259*^9}, {
   3.589303015948259*^9, 3.5893030164672585`*^9}, 3.589303146091259*^9, {
   3.589303184985259*^9, 3.589303204535259*^9}, {3.589303738278259*^9, 
   3.589303749916259*^9}, {3.5893841121720324`*^9, 3.5893841158520327`*^9}, {
   3.589384497119032*^9, 3.5893845004790325`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptpm", "[", 
   RowBox[{
    RowBox[{"\[CapitalDelta]_", "?", "NumericQ"}], ",", 
    RowBox[{"Field_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Delta]I_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sigmapm", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Im", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{
            RowBox[{"sigmapm", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"sigmapm", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], "[",
           "3", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sigmapm", "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"obepm", "[", 
           RowBox[{"\[CapitalDelta]", ",", "Field", ",", "\[Delta]I"}], "]"}],
           ",", "ic"}], "]"}], "]"}], ",", 
       RowBox[{"Flatten", "[", "\[Rho]Mat2", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3.5"}], "}"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}]}], ",", "2"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884809990725613`*^9, 3.5884811010827613`*^9}, {
   3.588481156485301*^9, 3.588481159205573*^9}, {3.5884813026829195`*^9, 
   3.588481303122963*^9}, {3.5884817527379503`*^9, 3.5884817727289505`*^9}, {
   3.5884826039959507`*^9, 3.58848260429895*^9}, {3.5884829092079506`*^9, 
   3.5884829093119507`*^9}, {3.5884856917393064`*^9, 
   3.5884857344093065`*^9}, {3.588486479401307*^9, 3.5884864994873066`*^9}, {
   3.588500079848832*^9, 3.588500105099832*^9}, {3.5885027812570753`*^9, 
   3.5885027813690863`*^9}, {3.5885028144103904`*^9, 
   3.5885028256595154`*^9}, {3.5885107166684084`*^9, 
   3.5885107177234087`*^9}, {3.5885108261094084`*^9, 
   3.5885108262844086`*^9}, {3.588584670019052*^9, 3.588584673099052*^9}, {
   3.5885851535802107`*^9, 3.5885851543962927`*^9}, 3.5885851994537973`*^9, 
   3.5886037917887735`*^9, 3.588603824192774*^9, {3.588911785807418*^9, 
   3.5889117973525724`*^9}, {3.589177939328125*^9, 3.589177941640625*^9}, {
   3.589303826849259*^9, 3.589303843520259*^9}, {3.589305189353259*^9, 
   3.589305203032259*^9}, {3.589305848495259*^9, 3.589305891804259*^9}, {
   3.589306070848259*^9, 3.5893060724962587`*^9}, {3.589306271787259*^9, 
   3.589306283395259*^9}, 3.589307404092623*^9, {3.5893487662225423`*^9, 
   3.589348775651411*^9}, 3.5893488169364557`*^9, 3.5893488912575364`*^9, {
   3.589348945191064*^9, 3.589349005223859*^9}, {3.5893490392097797`*^9, 
   3.5893490515792956`*^9}, {3.589349136359121*^9, 3.5893491462579327`*^9}, {
   3.5893491983227158`*^9, 3.589349198952653*^9}, {3.5893492340061474`*^9, 
   3.5893492441651316`*^9}, {3.5893493070488424`*^9, 
   3.5893493072988176`*^9}, {3.5893499111594253`*^9, 3.589349915039037*^9}, {
   3.5893502069232826`*^9, 3.5893502076132274`*^9}, {3.5893508633127675`*^9, 
   3.589350871812087*^9}, {3.5893841332520323`*^9, 3.5893841446920323`*^9}, {
   3.589511538876129*^9, 3.5895115533019543`*^9}, {3.5895280272927227`*^9, 
   3.5895280305560493`*^9}, 3.5895280616371565`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptpm", "[", 
   RowBox[{"0", ",", "0", ",", "0"}], "]"}], "//", "Timing"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5884811622178745`*^9, 3.5884811844560976`*^9}, 
   3.58848123798345*^9, {3.5884813742600765`*^9, 3.588481375879238*^9}, 
   3.5884814332789774`*^9, {3.5884817751839504`*^9, 3.5884817757669506`*^9}, {
   3.5884826116019506`*^9, 3.5884826120339503`*^9}, 3.5884829890979505`*^9, {
   3.5884832115789504`*^9, 3.58848321566695*^9}, {3.588485279692381*^9, 
   3.5884852822366357`*^9}, {3.588485319318343*^9, 3.588485320253437*^9}, {
   3.588485374047816*^9, 3.5884853750159125`*^9}, {3.588485621753584*^9, 
   3.5884856409135*^9}, {3.588485716552307*^9, 3.5884857179923067`*^9}, {
   3.588485764309307*^9, 3.588485785804307*^9}, {3.588485838481307*^9, 
   3.5884859089403067`*^9}, {3.588486315707307*^9, 3.588486322602307*^9}, {
   3.5884863839663067`*^9, 3.5884864396663065`*^9}, {3.588486537924307*^9, 
   3.588486559109307*^9}, {3.5893052078682585`*^9, 3.5893052082602587`*^9}, 
   3.589305862698259*^9, {3.5893070156267805`*^9, 3.589307015794797*^9}, 
   3.589307245314747*^9, 3.589307420625276*^9, 3.589307596998912*^9, 
   3.589350876551708*^9, 3.5893841479620323`*^9, {3.589511560537368*^9, 
   3.589511560875387*^9}, 3.5895280647324667`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.12323399999999999632205316402178141288`5.111330458569407", ",", 
   RowBox[{"-", "0.047355979716340174`"}]}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5884811729309454`*^9, 3.5884811862102733`*^9}, 
   3.5884812392565775`*^9, {3.5884813506067114`*^9, 3.588481377239374*^9}, 
   3.5884814343170815`*^9, 3.58848178693095*^9, 3.58848181706295*^9, 
   3.58848261496395*^9, {3.5884828905209503`*^9, 3.58848291533895*^9}, 
   3.5884829911599503`*^9, {3.5884832067199507`*^9, 3.5884832167739506`*^9}, 
   3.5884833976229506`*^9, 3.588484074067917*^9, 3.5884841487339168`*^9, 
   3.588484214232917*^9, 3.5884851706634793`*^9, 3.588485290162428*^9, 
   3.5884853241918306`*^9, 3.5884853798673973`*^9, {3.5884856301614246`*^9, 
   3.588485646226031*^9}, {3.5884856974023066`*^9, 3.588485786996307*^9}, {
   3.5884858391593065`*^9, 3.588485866628307*^9}, {3.588485896700307*^9, 
   3.588485910147307*^9}, {3.588486318615307*^9, 3.5884863233413067`*^9}, {
   3.5884864109753065`*^9, 3.588486448510307*^9}, 3.588486517943307*^9, {
   3.588486555193307*^9, 3.588486560129307*^9}, {3.588500097929832*^9, 
   3.5885001079908323`*^9}, 3.588502791373087*^9, {3.5885028223091803`*^9, 
   3.58850282931088*^9}, {3.5885108225894084`*^9, 3.5885108304424086`*^9}, 
   3.588522599895542*^9, 3.5885278674816465`*^9, 3.5885734948253064`*^9, 
   3.5885749002443066`*^9, 3.5885769873331413`*^9, 3.588580170311493*^9, 
   3.588581594707052*^9, 3.5885838257740517`*^9, 3.588584887739052*^9, 
   3.5885851664775004`*^9, 3.58858520967782*^9, 3.5886042047647734`*^9, 
   3.5886528466634254`*^9, 3.58892810540625*^9, 3.588928374*^9, 
   3.58892858003125*^9, 3.589089374328125*^9, 3.589120459*^9, 
   3.589191651046875*^9, {3.589303857584259*^9, 3.589303871801259*^9}, {
   3.589305180060259*^9, 3.5893052129112587`*^9}, {3.589305382181259*^9, 
   3.5893053917132587`*^9}, 3.589305897955259*^9, 3.589306077067259*^9, 
   3.589306810006259*^9, {3.5893070165768757`*^9, 3.5893070394091587`*^9}, 
   3.5893070759318104`*^9, 3.5893072164858646`*^9, 3.589307247380954*^9, {
   3.589307393518566*^9, 3.5893074811143246`*^9}, {3.5893075978379955`*^9, 
   3.5893076460248137`*^9}, 3.5893486580055304`*^9, 3.589348695351048*^9, 
   3.5893488960969553`*^9, {3.5893489499904876`*^9, 3.5893490078535433`*^9}, {
   3.589349141748474*^9, 3.589349172305318*^9}, {3.5893492401755304`*^9, 
   3.5893492468648615`*^9}, 3.5893493117383738`*^9, 3.589350877191657*^9, {
   3.5893841580220327`*^9, 3.5893841736120324`*^9}, 3.589396860125667*^9, 
   3.589467114632085*^9, 3.589482212180414*^9, 3.5894822835295477`*^9, 
   3.589511561366415*^9, 3.5895138080914173`*^9, 3.589515143402417*^9, {
   3.5895280350624995`*^9, 3.5895280752655196`*^9}, 3.589528748453125*^9, 
   3.589788600143111*^9, 3.5897923207552185`*^9, 3.5898685475000277`*^9, 
   3.596447636737703*^9, 3.596482596811925*^9, 3.598065463130847*^9, 
   3.59809800653113*^9, 3.5981969201761856`*^9, 3.611028783165834*^9, 
   3.6110291152376623`*^9, 3.611029911990493*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
for sigma-, sigma+ transitions with n between n=19 and n=28\
\>", "Subsubsection",
 CellChangeTimes->{{3.6110453308185167`*^9, 3.6110453505998373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianmp", "=", 
   RowBox[{"HMatrix", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1", ",", "nEval"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.611045396915556*^9, 3.61104540116777*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonianmp", "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.611045402720831*^9, 3.6110454034846277`*^9}}],

Cell[BoxData[
 RowBox[{"sigmamp", "=", 
  RowBox[{"stateList", "[", 
   RowBox[{"-", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.611045405634774*^9, 3.611045414319584*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Rho]mp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"commutator", "[", 
      RowBox[{"Hamiltonianmp", ",", "\[Rho]Mat"}], "]"}]}], "+", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"\[Rho]dotDecay", "+", "\[Rho]dotDephasing"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "p"], "\[Rule]", "6"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r1"], "\[Rule]", "0.05"}], ",", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "r2"], "\[Rule]", "0.05"}], ",", " ", 
        RowBox[{"\[Gamma]p", "\[Rule]", "0.1"}], ",", 
        RowBox[{"\[Gamma]c", "\[Rule]", "1."}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6110454165309267`*^9, 3.611045420657708*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obemp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"\[Rho]Mat", ",", "t"}], "]"}], ",", "d\[Rho]mp"}], "}"}], 
        ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"\[Delta]c", "\[Rule]", "#1"}], ",", 
       RowBox[{"BField", "\[Rule]", "#2"}], ",", " ", 
       RowBox[{"\[Delta]p", "\[Rule]", "#3"}]}], "}"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{"Equal", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]Mat", "/.", 
         RowBox[{"t", "\[Rule]", "0"}]}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0.2", ",", 
             RowBox[{"{", "5", "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "13", "}"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
      "2"}], "]"}], "//", "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.611045427504816*^9, 3.611045431618514*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptmp", "[", 
   RowBox[{
    RowBox[{"\[CapitalDelta]_", "?", "NumericQ"}], ",", 
    RowBox[{"Field_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Delta]I_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sigmamp", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Im", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{
            RowBox[{"sigmamp", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"sigmamp", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], "[",
           "3", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sigmamp", "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"obemp", "[", 
           RowBox[{"\[CapitalDelta]", ",", "Field", ",", "\[Delta]I"}], "]"}],
           ",", "ic"}], "]"}], "]"}], ",", 
       RowBox[{"Flatten", "[", "\[Rho]Mat2", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3.5"}], "}"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}]}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6110454371500483`*^9, 3.6110454510654707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptmp", "[", 
   RowBox[{"0", ",", "0", ",", "0"}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.6110454560235453`*^9, 3.6110454567002*^9}}]
}, Open  ]],

Cell["", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.611044513989381*^9, 3.611044519858828*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Try to integrate", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.589384715379032*^9, 3.589384717789032*^9}}],

Cell[CellGroupData[{

Cell["Try to integrate", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.588522919224016*^9, 3.5885229242343025`*^9}}],

Cell["\<\
Grid corresponds to integrate a spectrum from -20 to 20 over velocities up to \
15\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5889127267335014`*^9, 3.588912766918519*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridRed", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "320"}], ",", "320", ",", "0.3"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gridBlue", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "550"}], ",", "550", ",", "0.3"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588501243197832*^9, 3.5885013942158318`*^9}, 
   3.588501433301832*^9, {3.588501481658832*^9, 3.588501491569832*^9}, {
   3.5885104642034082`*^9, 3.5885104741944084`*^9}, {3.5885113942474084`*^9, 
   3.588511411830408*^9}, {3.588511459500408*^9, 3.5885115124314084`*^9}, {
   3.5886068790027733`*^9, 3.5886069003427734`*^9}, {3.5886527387600584`*^9, 
   3.5886527849663615`*^9}, {3.588653085814292*^9, 3.5886531120421934`*^9}, {
   3.588653986652201*^9, 3.588653992001827*^9}, {3.588654382873785*^9, 
   3.5886543866335216`*^9}, {3.5889121164444785`*^9, 3.588912121809015*^9}, 
   3.588912245533386*^9, {3.588912533344164*^9, 3.588912535735403*^9}, 
   3.589089334984375*^9, {3.5893509345040836`*^9, 3.589350937023882*^9}, {
   3.5893843977320323`*^9, 3.5893844169720325`*^9}, {3.611029270170232*^9, 
   3.611029279160125*^9}, {3.6110296164731503`*^9, 3.611029621375821*^9}, {
   3.6110422479491253`*^9, 3.6110422508663387`*^9}, {3.611042282545261*^9, 
   3.6110422951126957`*^9}, {3.61104404304078*^9, 3.611044055048614*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"susceptmp", "[", 
   RowBox[{"50", ",", "0", ",", "20"}], "]"}], "//", "Timing"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588510998245408*^9, 3.5885111028574085`*^9}, {
   3.5885111990274086`*^9, 3.5885112176504087`*^9}, {3.5885112579114084`*^9, 
   3.588511293429408*^9}, {3.588527944594582*^9, 3.5885279852502537`*^9}, {
   3.5886069504227734`*^9, 3.5886069836657734`*^9}, {3.5886528009160852`*^9, 
   3.5886528024959593`*^9}, {3.588652975063153*^9, 3.5886530352883344`*^9}, {
   3.5886539207068176`*^9, 3.588653944995117*^9}, {3.5886542717368336`*^9, 
   3.588654274912833*^9}, {3.5889124383806686`*^9, 3.5889124659254227`*^9}, {
   3.5889125216709967`*^9, 3.588912540351865*^9}, {3.588928169546875*^9, 
   3.58892816978125*^9}, {3.589089255953125*^9, 3.589089256453125*^9}, {
   3.589178195125*^9, 3.58917819540625*^9}, {3.5893842436120324`*^9, 
   3.5893842478820324`*^9}, 3.5895288238125*^9, {3.5981961474082084`*^9, 
   3.5981961476882143`*^9}, 3.598196435855977*^9, {3.611044395057086*^9, 
   3.611044396350338*^9}, {3.611045465313095*^9, 3.61104546608259*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.20976200000000000400746102968696504831`5.342326728476238", ",", 
   "0.0012570880288877782`"}], "}"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5885110272164087`*^9, 3.588511112243408*^9}, {
   3.5885112059504085`*^9, 3.588511219026408*^9}, {3.5885112619094086`*^9, 
   3.5885113021294084`*^9}, 3.5885226859200935`*^9, {3.5885279426289787`*^9, 
   3.588527991179264*^9}, {3.5886069664967737`*^9, 3.5886069888057737`*^9}, 
   3.588652802955922*^9, {3.588652969933563*^9, 3.5886529960014777`*^9}, 
   3.5886530260590725`*^9, 3.588653056956601*^9, {3.5886539325659876`*^9, 
   3.588653950084761*^9}, 3.5886542819688334`*^9, 3.588654406152155*^9, {
   3.5889124392707577`*^9, 3.588912466925523*^9}, {3.588912522571087*^9, 
   3.5889125425960894`*^9}, 3.588928173046875*^9, 3.58892864040625*^9, 
   3.589120468125*^9, 3.589178196703125*^9, 3.5893508876008244`*^9, {
   3.5893844021320324`*^9, 3.589384421332032*^9}, 3.5893849861300325`*^9, 
   3.5893968778449583`*^9, 3.589482324642659*^9, 3.589528826765625*^9, 
   3.58979239667681*^9, 3.5898685544337206`*^9, 3.596482666457925*^9, 
   3.598065465035847*^9, 3.5980980135801296`*^9, 3.598196940897014*^9, 
   3.6110299123513527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"integrateTablemp", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[CapitalDelta]", ",", "B", ",", "\[Delta]p"}], "}"}], ",", 
         RowBox[{"susceptmp", "[", 
          RowBox[{"\[CapitalDelta]", ",", 
           StyleBox["B",
            FontWeight->"Plain"], ",", "\[Delta]p"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]", ",", "gridBlue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"B", ",", 
         RowBox[{"-", "0.8"}], ",", "0.8", ",", "0.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Delta]p", ",", "gridRed"}], "}"}]}], "]"}], ",", "2"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588501229054832*^9, 3.588501230929832*^9}, {
   3.5885015231748323`*^9, 3.588501596658832*^9}, {3.5885016359208317`*^9, 
   3.588501638871832*^9}, {3.588501688029832*^9, 3.588501706491832*^9}, {
   3.5885017515378323`*^9, 3.588501900687832*^9}, {3.588501943324832*^9, 
   3.588501992201832*^9}, {3.588502101496106*^9, 3.5885021613460903`*^9}, {
   3.588502196475603*^9, 3.5885022374126964`*^9}, {3.588502329087863*^9, 
   3.5885024437323265`*^9}, {3.588510134936408*^9, 3.5885101776494083`*^9}, {
   3.5885102500574083`*^9, 3.5885102921344085`*^9}, {3.5885105212234087`*^9, 
   3.5885105257114086`*^9}, {3.5885105640204086`*^9, 
   3.5885106255364084`*^9}, {3.5885111210974083`*^9, 
   3.5885111359044085`*^9}, {3.5885112235704083`*^9, 
   3.5885112382814083`*^9}, {3.5885113064454083`*^9, 
   3.5885113216044083`*^9}, {3.5885115249444084`*^9, 
   3.5885115436214085`*^9}, {3.5885226917389035`*^9, 
   3.5885226954215107`*^9}, {3.588606654362774*^9, 3.5886066573517733`*^9}, 
   3.5886070287927732`*^9, {3.588654025550478*^9, 3.588654034049883*^9}, {
   3.588911522708111*^9, 3.5889116561934576`*^9}, {3.588912241101943*^9, 
   3.5889122732231545`*^9}, {3.5889126676615944`*^9, 
   3.5889127000698347`*^9}, {3.5889127860254297`*^9, 
   3.5889128141782446`*^9}, {3.58892817659375*^9, 3.588928194390625*^9}, {
   3.589089246296875*^9, 3.58908924678125*^9}, {3.589089431734375*^9, 
   3.58908943184375*^9}, {3.589167453859375*^9, 3.589167464296875*^9}, {
   3.589167534421875*^9, 3.589167539140625*^9}, {3.589178212296875*^9, 
   3.589178217546875*^9}, 3.589350945823178*^9, {3.589384252492032*^9, 
   3.5893842538520327`*^9}, 3.5893844288020325`*^9, {3.589482220600256*^9, 
   3.5894822207682724`*^9}, 3.5895282067936707`*^9, {3.598196150328267*^9, 
   3.598196153938339*^9}, {3.5981964321959043`*^9, 3.5981964340859423`*^9}, {
   3.611044400227149*^9, 3.6110444040478287`*^9}, {3.611045467458539*^9, 
   3.611045472044565*^9}}],

Cell[BoxData["$Aborted"], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.611029951062347*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{"Save", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\</home/atknoop/Jannie\>\"", ",", "\"\<IntegrateTable\>\"", ",", 
        RowBox[{"\"\<BreitRabi_\>\"", "<>", 
         RowBox[{"ToString", " ", "[", "nEval", "]"}], "<>", 
         "\"\<_mp_table.m\>\""}]}], "}"}], "]"}], ",", "integrateTablemp"}], 
    "]"}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5886554750844936`*^9, 3.588655491363517*^9}, 
   3.589384738049032*^9, {3.5894671840904074`*^9, 3.589467184418008*^9}, {
   3.5894822235035458`*^9, 3.5894822251427097`*^9}, {3.589789130989111*^9, 
   3.589789134026111*^9}, {3.5897922795620995`*^9, 3.589792283450488*^9}, 
   3.596482521757925*^9, {3.5980654001648474`*^9, 3.5980654086068473`*^9}, {
   3.5981956810988827`*^9, 3.598195774790756*^9}, {3.598195846822197*^9, 
   3.5981958837629356`*^9}, {3.598196158788436*^9, 3.598196159088442*^9}, 
   3.5981962957311745`*^9, {3.598196428835837*^9, 3.59819643047587*^9}, {
   3.5981965094277563`*^9, 3.59819660528159*^9}, {3.611041953942552*^9, 
   3.611042039740328*^9}, {3.61104265250124*^9, 3.61104265676547*^9}, 
   3.6110439945624533`*^9, {3.611044408657267*^9, 3.6110444127518597`*^9}, {
   3.611045477312827*^9, 3.6110454810739603`*^9}}],

Cell[CellGroupData[{

Cell["Read in the table\[LineSeparator]", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5886477855875034`*^9, 3.58864778867568*^9}, 
   3.5886511838480587`*^9}],

Cell[BoxData[
 RowBox[{"(*", "integrateTablepm", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588614975793316*^9, 3.588614978592316*^9}, 
   3.588928241203125*^9, {3.58908927984375*^9, 3.589089280203125*^9}, 
   3.5893842812620325`*^9, 3.5893847607290325`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolate and Integrate", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5886478144011517`*^9, 3.5886478186523943`*^9}}],

Cell[BoxData[
 RowBox[{"fIntegratemp", "=", 
  RowBox[{"Interpolation", "[", "integrateTablemp", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5885024530362563`*^9, 3.588502459628916*^9}, {
  3.588564937571542*^9, 3.588564939373722*^9}, {3.58892824859375*^9, 
  3.588928259421875*^9}, {3.58908928425*^9, 3.58908928465625*^9}, {
  3.589089461890625*^9, 3.58908946253125*^9}, {3.5893842828120327`*^9, 
  3.5893842840220327`*^9}, {3.589482233069503*^9, 3.5894822350316987`*^9}, {
  3.598196171598692*^9, 3.59819617498876*^9}, {3.5981964192656455`*^9, 
  3.59819642048567*^9}, {3.611044416823058*^9, 3.611044422877324*^9}, {
  3.611045486689053*^9, 3.611045500161018*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589270791476601*^9, 3.589270793028601*^9}, 
   3.5893843021020327`*^9, {3.5893847774890323`*^9, 3.589384778149032*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export result", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5964625120475087`*^9, 3.5964625146574564`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportTable", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B", ",", "\[CapitalDelta]", ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fIntegratemp", "[", 
               RowBox[{
                RowBox[{"\[CapitalDelta]", "-", 
                 FractionBox[
                  RowBox[{" ", "v"}], 
                  RowBox[{"486", " ", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "3"}]]}]]}], ",", "B", ",", 
                FractionBox[
                 RowBox[{" ", "v"}], 
                 RowBox[{"780", " ", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}]]}], "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["v", "240"], ")"}], "2"]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"-", "240"}], ",", "240"}], "}"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "6"}]}], "]"}], "]"}]}], 
         "}"}], "//", "Flatten"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]", ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.2"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"B", ",", 
       RowBox[{"-", "0.8"}], ",", "0.8", ",", "0.4"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589802133296613*^9, 3.5898021471566324`*^9}, {
   3.5965203807544575`*^9, 3.5965203822984576`*^9}, 3.598196206299386*^9, 
   3.5981964006052723`*^9, {3.6110423649880323`*^9, 3.6110423669023323`*^9}, {
   3.611044032282639*^9, 3.6110440393791037`*^9}, {3.6110444257194767`*^9, 
   3.611044426199379*^9}, {3.611045504492733*^9, 3.611045505455818*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5981966972952704`*^9, 3.5981967243463526`*^9}}],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\</home/atknoop/Jannie\>\"", ",", "\"\<IntegrationResults\>\"", ",", 
      RowBox[{"\"\<table_\>\"", "<>", 
       RowBox[{"ToString", " ", "[", "nEval", "]"}], "<>", 
       "\"\<s_mp.csv\>\""}]}], "}"}], "]"}], ",", 
   RowBox[{"Flatten", "[", 
    RowBox[{"exportTable", ",", "1"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589802336309423*^9, 3.5898024065595217`*^9}, 
   3.596463485808033*^9, 3.596482535172925*^9, 3.5980654218678474`*^9, {
   3.5981959348639574`*^9, 3.5981959894650497`*^9}, {3.598196048036221*^9, 
   3.598196052266306*^9}, 3.5981962097494555`*^9, 3.598196398145223*^9, 
   3.5981967274364758`*^9, {3.611042160002211*^9, 3.61104221617869*^9}, {
   3.611042690803557*^9, 3.611042697245553*^9}, 3.611043998552476*^9, {
   3.6110444310699244`*^9, 3.611044431936421*^9}, {3.6110455142704897`*^9, 
   3.611045515063794*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1448, 856},
WindowMargins->{{7, Automatic}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Text"], FontFamily -> "Tahoma", FontSize -> 12, FontWeight -> 
    "Plain", FontSlant -> "Plain", FontColor -> 
    RGBColor[0.01680018310826276, 0.19832150759136338`, 1.]], 
   Cell[
    StyleData["Subsection"], FontFamily -> "Helvetica", FontSize -> 14, 
    FontWeight -> "Bold", FontSlant -> "Plain"], 
   Cell[
    StyleData["Subsubsection"], FontFamily -> "Helvetica", FontSize -> 11, 
    FontWeight -> "Bold", FontSlant -> "Plain"]}, Visible -> False, 
  FrontEndVersion -> 
  "9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, 2013)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 196, 3, 114, "Title",
 InitializationCell->True],
Cell[778, 27, 489, 8, 39, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1292, 39, 50, 1, 36, "Subsubtitle",
 InitializationCell->True],
Cell[1345, 42, 559, 10, 35, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1929, 56, 129, 2, 100, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2083, 62, 137, 2, 44, "Subsection",
 InitializationCell->True],
Cell[2223, 66, 101, 3, 35, "Input",
 InitializationCell->True],
Cell[2327, 71, 1039, 27, 81, "Input",
 InitializationCell->True],
Cell[3369, 100, 592, 16, 57, "Input",
 InitializationCell->True],
Cell[3964, 118, 619, 17, 57, "Input",
 InitializationCell->True],
Cell[4586, 137, 441, 13, 36, "Input",
 InitializationCell->True],
Cell[5030, 152, 146, 2, 37, "Text",
 InitializationCell->True],
Cell[5179, 156, 1029, 29, 36, "Input",
 InitializationCell->True],
Cell[6211, 187, 313, 8, 37, "Text",
 InitializationCell->True],
Cell[6527, 197, 950, 26, 57, "Input",
 InitializationCell->True],
Cell[7480, 225, 1121, 29, 57, "Input",
 InitializationCell->True],
Cell[8604, 256, 584, 17, 36, "Input",
 InitializationCell->True],
Cell[9191, 275, 318, 6, 37, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[9534, 285, 880, 26, 49, "Input",
 InitializationCell->True],
Cell[10417, 313, 1446, 33, 48, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[11900, 351, 405, 9, 36, "Input",
 InitializationCell->True],
Cell[12308, 362, 1490, 33, 48, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[13835, 400, 152, 2, 30, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14012, 406, 1473, 42, 10487, "Input",
 InitializationCell->True],
Cell[15488, 450, 1096, 19, 87, "Output",
 InitializationCell->True],
Cell[16587, 471, 1097, 19, 87, "Output",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[17733, 496, 152, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[17910, 502, 2697, 79, 20032, "Input",
 InitializationCell->True],
Cell[20610, 583, 1261, 20, 87, "Message",
 InitializationCell->True],
Cell[21874, 605, 905, 15, 87, "Output",
 InitializationCell->True],
Cell[22782, 622, 949, 17, 87, "Output",
 InitializationCell->True],
Cell[23734, 641, 949, 17, 87, "Output",
 InitializationCell->True],
Cell[24686, 660, 1262, 20, 87, "Message",
 InitializationCell->True],
Cell[25951, 682, 905, 15, 87, "Output",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[26905, 703, 387, 13, 24, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[27317, 720, 912, 25, 5815, "Input",
 InitializationCell->True],
Cell[28232, 747, 1344, 21, 87, "Message",
 InitializationCell->True],
Cell[29579, 770, 1344, 21, 87, "Message",
 InitializationCell->True],
Cell[30926, 793, 1611, 37, 87, "Output",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[32586, 836, 224, 3, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[32835, 843, 149, 3, 2843, "Input",
 InitializationCell->True],
Cell[32987, 848, 1509, 22, 87, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[34511, 873, 6801, 160, 16385, "Input",
 InitializationCell->True],
Cell[41315, 1035, 1583, 46, 10703, "Input",
 InitializationCell->True],
Cell[42901, 1083, 1183, 28, 4441, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[44121, 1116, 306, 5, 21, "Subsubsection",
 InitializationCell->True],
Cell[44430, 1123, 121, 2, 2843, "Input",
 InitializationCell->True],
Cell[44554, 1127, 3162, 78, 14788, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[47741, 1209, 667, 14, 3270, "Input",
 InitializationCell->True],
Cell[48411, 1225, 1641, 24, 87, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[50089, 1254, 313, 9, 3270, "Input",
 InitializationCell->True],
Cell[50405, 1265, 865, 13, 87, "Output",
 InitializationCell->True]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51331, 1285, 296, 6, 47, "Subsection",
 InitializationCell->True],
Cell[51630, 1293, 1251, 42, 131, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[52906, 1339, 267, 6, 30, "Subsubsection",
 InitializationCell->True],
Cell[53176, 1347, 1825, 44, 131, "Input",
 InitializationCell->True],
Cell[55004, 1393, 137, 2, 37, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[55166, 1399, 762, 22, 36, "Input",
 InitializationCell->True],
Cell[55931, 1423, 1442, 48, 56, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[57388, 1474, 1844, 44, 65, "Input",
 InitializationCell->True],
Cell[59235, 1520, 161, 2, 37, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[59421, 1526, 422, 14, 36, "Input",
 InitializationCell->True],
Cell[59846, 1542, 940, 27, 35, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60823, 1574, 1615, 44, 57, "Input",
 InitializationCell->True],
Cell[62441, 1620, 901, 15, 48, "Message",
 InitializationCell->True],
Cell[63345, 1637, 876, 15, 48, "Message",
 InitializationCell->True],
Cell[64224, 1654, 878, 15, 48, "Message",
 InitializationCell->True],
Cell[65105, 1671, 841, 15, 29, "Message",
 InitializationCell->True]
}, Open  ]],
Cell[65961, 1689, 148, 2, 37, "Text",
 InitializationCell->True],
Cell[66112, 1693, 608, 15, 36, "Input",
 InitializationCell->True],
Cell[66723, 1710, 859, 21, 36, "Input",
 InitializationCell->True],
Cell[67585, 1733, 1041, 28, 57, "Input",
 InitializationCell->True],
Cell[68629, 1763, 641, 19, 57, "Input",
 InitializationCell->True],
Cell[69273, 1784, 1447, 39, 99, "Input",
 InitializationCell->True],
Cell[70723, 1825, 2324, 39, 57, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73096, 1870, 152, 3, 44, "Subsection",
 InitializationCell->True],
Cell[73251, 1875, 2294, 66, 159, "Input",
 InitializationCell->True],
Cell[75548, 1943, 580, 15, 36, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[76165, 1963, 292, 4, 44, "Subsection",
 InitializationCell->True],
Cell[76460, 1969, 1814, 50, 78, "Input",
 InitializationCell->True],
Cell[78277, 2021, 1401, 42, 78, "Input",
 InitializationCell->True],
Cell[79681, 2065, 875, 19, 88, "Text",
 InitializationCell->True],
Cell[80559, 2086, 324, 7, 37, "Text",
 InitializationCell->True],
Cell[80886, 2095, 936, 23, 57, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[81847, 2122, 462, 15, 33, "Subsubsection",
 InitializationCell->True],
Cell[82312, 2139, 132, 2, 37, "Text",
 InitializationCell->True],
Cell[82447, 2143, 654, 19, 59, "Input",
 InitializationCell->True],
Cell[83104, 2164, 206, 5, 35, "Input",
 InitializationCell->True],
Cell[83313, 2171, 130, 2, 37, "Text",
 InitializationCell->True],
Cell[83446, 2175, 588, 16, 59, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[84071, 2196, 524, 17, 33, "Subsubsection",
 InitializationCell->True],
Cell[84598, 2215, 131, 2, 37, "Text",
 InitializationCell->True],
Cell[84732, 2219, 1235, 25, 58, "Input",
 InitializationCell->True],
Cell[85970, 2246, 201, 3, 37, "Text",
 InitializationCell->True],
Cell[86174, 2251, 1337, 28, 59, "Input",
 InitializationCell->True],
Cell[87514, 2281, 206, 3, 37, "Text",
 InitializationCell->True],
Cell[87723, 2286, 1392, 29, 59, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[89152, 2320, 529, 17, 33, "Subsubsection",
 InitializationCell->True],
Cell[89684, 2339, 131, 2, 37, "Text",
 InitializationCell->True],
Cell[89818, 2343, 700, 18, 59, "Input",
 InitializationCell->True],
Cell[90521, 2363, 202, 3, 37, "Text",
 InitializationCell->True],
Cell[90726, 2368, 805, 21, 58, "Input",
 InitializationCell->True],
Cell[91534, 2391, 204, 3, 37, "Text",
 InitializationCell->True],
Cell[91741, 2396, 833, 21, 59, "Input",
 InitializationCell->True],
Cell[92577, 2419, 683, 13, 36, "Input",
 InitializationCell->True],
Cell[93263, 2434, 1559, 36, 41, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94871, 2476, 277, 5, 44, "Subsection",
 InitializationCell->True],
Cell[95151, 2483, 1675, 46, 98, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[96863, 2534, 347, 7, 47, "Subsection",
 InitializationCell->True],
Cell[97213, 2543, 624, 13, 65, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[97862, 2560, 1836, 38, 57, "Input",
 InitializationCell->True],
Cell[99701, 2600, 2121, 40, 93, "Output",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101883, 2647, 141, 2, 100, "Section",
 InitializationCell->True],
Cell[102027, 2651, 2626, 73, 78, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[104678, 2728, 356, 6, 35, "Input",
 InitializationCell->True],
Cell[105037, 2736, 1237, 30, 69, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[106311, 2771, 157, 2, 44, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[106493, 2777, 331, 5, 30, "Subsubsection",
 InitializationCell->True],
Cell[106827, 2784, 749, 13, 35, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[107601, 2801, 561, 9, 36, "Input",
 InitializationCell->True],
Cell[108165, 2812, 1068, 27, 62, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[109248, 2842, 2505, 45, 41, "Input",
 InitializationCell->True],
Cell[111756, 2889, 2295, 52, 57, "Input",
 InitializationCell->True],
Cell[114054, 2943, 3475, 68, 78, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[117554, 3015, 1266, 19, 36, "Input",
 InitializationCell->True],
Cell[118823, 3036, 2969, 42, 35, "Output",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121841, 3084, 285, 5, 30, "Subsubsection",
 InitializationCell->True],
Cell[122129, 3091, 747, 15, 35, "Input",
 InitializationCell->True],
Cell[122879, 3108, 181, 4, 35, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[123085, 3116, 534, 10, 36, "Input",
 InitializationCell->True],
Cell[123622, 3128, 1037, 27, 62, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[124674, 3158, 2453, 44, 41, "Input",
 InitializationCell->True],
Cell[127130, 3204, 2249, 52, 57, "Input",
 InitializationCell->True],
Cell[129382, 3258, 3423, 67, 78, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[132830, 3329, 1220, 19, 36, "Input",
 InitializationCell->True],
Cell[134053, 3350, 2935, 43, 35, "Output",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137037, 3399, 335, 5, 30, "Subsubsection",
 InitializationCell->True],
Cell[137375, 3406, 767, 14, 35, "Input",
 InitializationCell->True],
Cell[138145, 3422, 281, 6, 35, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[138451, 3432, 561, 9, 36, "Input",
 InitializationCell->True],
Cell[139015, 3443, 1127, 28, 62, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[140157, 3474, 2505, 45, 41, "Input",
 InitializationCell->True],
Cell[142665, 3521, 2351, 53, 57, "Input",
 InitializationCell->True],
Cell[145019, 3576, 3555, 69, 78, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[148599, 3649, 1318, 20, 36, "Input",
 InitializationCell->True],
Cell[149920, 3671, 3041, 43, 35, "Output",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153010, 3720, 162, 3, 30, "Subsubsection"],
Cell[153175, 3725, 239, 6, 35, "Input"],
Cell[153417, 3733, 157, 3, 35, "Input"],
Cell[153577, 3738, 176, 4, 36, "Input"],
Cell[153756, 3744, 857, 22, 41, "Input"],
Cell[154616, 3768, 1306, 38, 57, "Input"],
Cell[155925, 3808, 1615, 41, 78, "Input"],
Cell[157543, 3851, 191, 4, 36, "Input"]
}, Open  ]],
Cell[157749, 3858, 118, 2, 30, "Subsubsection",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[157916, 3866, 128, 2, 100, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[158069, 3872, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[158205, 3876, 201, 5, 37, "Text",
 InitializationCell->True],
Cell[158409, 3883, 1613, 33, 57, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[160047, 3920, 1124, 17, 36, "Input",
 InitializationCell->True],
Cell[161174, 3939, 1242, 20, 35, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[162453, 3964, 2781, 52, 36, "Input",
 InitializationCell->True],
Cell[165237, 4018, 104, 2, 35, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[165356, 4023, 1333, 25, 57, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[166714, 4052, 180, 3, 47, "Subsubsection",
 InitializationCell->True],
Cell[166897, 4057, 282, 5, 36, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[167216, 4067, 147, 2, 30, "Subsubsection",
 InitializationCell->True],
Cell[167366, 4071, 690, 11, 36, "Input",
 InitializationCell->True],
Cell[168059, 4084, 195, 3, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[168303, 4093, 132, 2, 44, "Subsection",
 InitializationCell->True],
Cell[168438, 4097, 2010, 49, 133, "Input",
 InitializationCell->True],
Cell[170451, 4148, 123, 2, 35, "Input",
 InitializationCell->True],
Cell[170577, 4152, 1001, 20, 57, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
